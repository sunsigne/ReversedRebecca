TIME -> 0 = GOTO -> NAME:SARAH, BLOCKING_PATH:FALSE


//// STATE ////

$ -> TA_NULL = TRIPLE_ACTION -> NULL
$ -> WAITFOR_NULL = WAITFOR -> NULL
! -> PUSH_SARAH_TO_RIGHT = GOTO -> FACING:LEFT, PUSH:RIGHT


//// VLADIMIR CUTSCENE ////

! -> VLADIMIR_ARRIVAL = GOTO -> TP:20-55, FACING:RIGHT, EXPRESSION:EXCLAMATION
TALKED -> MIKA_DAMN_IT = WAITFOR -> TIMER:1 ? SLOW:22-55, BLOCKING_PATH:TRUE
GOAL -> 22-55 = SLOW -> 25-55

! -> INVESTIGATION_LETS_GO = GOTO -> MEMORY:SCENARIO_EXIT, AFFECTING:SCENARIO_EXIT, AFFECTING:START_LEVEL
! -> INVESTIGATION_LETS_DO_THE_OPPOSITE = TALK -> SARAH_LETS_DO_THE_OPPOSITE
TALKED -> SARAH_LETS_DO_THE_OPPOSITE = GOTO -> MEMORY:SCENARIO_INQUIRY, AFFECTING:SCENARIO_INQUIRY, AFFECTING:START_LEVEL
! -> START_LEVEL = GOTO -> PLAYER_AVOIDER_TYPE:AROUND, CUTSCENE:STOP


//// INQUIRY DOWN DESKS ////

! -> SCENARIO_INQUIRY = WAITFOR -> TIMER:2 ? SLOW:26-44
GOAL -> 26-44 = MEMORY -> SARAH_HAS_CYAN_KEY ? FACING:UP, BLOCKING_SIGHT:FALSE, PARSE_SARAH_WILL_NOTICE_DOOR_IS_OPENED / BLOCKING_SIGHT:FALSE, WAITFOR_PARSE_JEAN_STUNNED
$ -> PARSE_SARAH_WILL_NOTICE_DOOR_IS_OPENED = MEMORY -> SARAH_WILL_NOTICE_DOOR_IS_OPENED ? PLAYER_AVOIDER_TYPE:AROUND, EXPRESSION:SUSPENSION, WAITFOR_START_SEARCHING_PLAYER_WHICH_OPENED_DOOR / SLOW:26-42
$ -> PARSE_SARAH_SEE_PLAYER_WHICH_OPENED_DOOR = SEE -> PLAYER ? SARAH_SEE_PLAYER_WHICH_OPENED_DOOR_SECOND_VERIFICATION / NULL
$ -> WAITFOR_START_SEARCHING_PLAYER_WHICH_OPENED_DOOR = WAITFOR -> TIMER:1 ? WAITFOR_FACING_LEFT_OPENED_CYAN_DOOR, PARSE_SARAH_SEE_PLAYER_WHICH_OPENED_DOOR
$ -> SARAH_SEE_PLAYER_WHICH_OPENED_DOOR_SECOND_VERIFICATION = PLAYER_CLOSER_THAN -> 6 ? CUTSCENE:START, EXPRESSION:EXCLAMATION, FACING:REBECCA, MOVE:STOP, WAITING_TALK_SARAH_OPENED_CYAN_DOOR / NULL
$ -> WAITFOR_FACING_LEFT_OPENED_CYAN_DOOR = WAITFOR -> TIMER:1 ? FACING:LEFT, WAITFOR_FACING_RIGHT_OPENED_CYAN_DOOR, PARSE_SARAH_SEE_PLAYER_WHICH_OPENED_DOOR
$ -> WAITFOR_FACING_RIGHT_OPENED_CYAN_DOOR = WAITFOR -> TIMER:1 ? FACING:RIGHT, WAITFOR_FACING_DOWN_OPENED_CYAN_DOOR, PARSE_SARAH_SEE_PLAYER_WHICH_OPENED_DOOR
$ -> WAITFOR_FACING_DOWN_OPENED_CYAN_DOOR = WAITFOR -> TIMER:1 ? FACING:DOWN, WAITFOR_FACING_UP_OPENED_CYAN_DOOR, PARSE_SARAH_SEE_PLAYER_WHICH_OPENED_DOOR
$ -> WAITFOR_FACING_UP_OPENED_CYAN_DOOR = WAITFOR -> TIMER:1 ? FACING:UP, WAITFOR_SUSPENSION_OPENED_CYAN_DOOR, PARSE_SARAH_SEE_PLAYER_WHICH_OPENED_DOOR
$ -> WAITFOR_SUSPENSION_OPENED_CYAN_DOOR = WAITFOR -> TIMER:1 ? EXPRESSION:SUSPENSION, WAITFOR_HEADING_CYAN_DOOR, PARSE_SARAH_SEE_PLAYER_WHICH_OPENED_DOOR
$ -> WAITFOR_HEADING_CYAN_DOOR = WAITFOR -> TIMER:2 ? PLAYER_AVOIDER_TYPE:STOP, SLOW:26-39, PARSE_SARAH_SEE_PLAYER_WHICH_OPENED_DOOR
$ -> WAITING_TALK_SARAH_OPENED_CYAN_DOOR = WAITFOR -> TIMER:1 ? TALK:SARAH_OPENED_CYAN_DOOR
TALKED -> SARAH_OPENED_CYAN_DOOR = GOTO -> CUTSCENE:STOP, PLAYER_AVOIDER_TYPE:STOP, SLOW:26-39
$ -> WAITFOR_PARSE_JEAN_STUNNED = WAITFOR -> TIMER:2 ? PLAYER_AVOIDER_TYPE:CUTSCENE, PARSE_JEAN_STUNNED 
$ -> PARSE_JEAN_STUNNED = STUNNED -> JEAN ? PLAYER_AVOIDER_TYPE:STOP, SLOW:29-44 / FACING:LEFT, MEMORY:SARAH_ASKING_JEAN_ABOUT_KEYS, WAITFOR_SARAH_STOP_WAITING_FOR_ASKING_JEAN_ABOUT_KEYS
$ -> WAITFOR_SARAH_STOP_WAITING_FOR_ASKING_JEAN_ABOUT_KEYS = WAITFOR -> TIMER:3 ? MEMORY:SARAH_STOP_WAITING_FOR_ASKING_JEAN_ABOUT_KEYS, PLAYER_AVOIDER_TYPE:STOP, SLOW:29-44
GOAL -> 29-44 = GOTO -> MEMORY:SARAH_CANT_KNOW_CYAN_DOOR_IS_OPENED, SLOW:32-44
! -> SARAH_WILL_ENTER_JEAN_ROOM = WAITFOR -> TIMER:1 ? PLAYER_AVOIDER_TYPE:FORCE, SLOW:24-44
GOAL -> 24-44 = GOTO -> PLAYER_AVOIDER_TYPE:STOP, BLOCKING_SIGHT:TRUE, CREATE_DESK_KEY_ROOM_PATH_CHECKER, AFFECTING:INIT_DESK_KEY_ROOM_PATH_CHECKER, PARSE_SARAH_SEE_PLAYER_WHILE_SEARCHING_CYAN_KEY
$ -> CREATE_DESK_KEY_ROOM_PATH_CHECKER = CREATE -> 17-44-BACK:14-255-255
$ -> PARSE_SARAH_SEE_PLAYER_WHILE_SEARCHING_CYAN_KEY = MEMORY -> SARAH_SEE_PLAYER_WHILE_SEARCHING_CYAN_KEY ? AFFECTING:SARAH_CYAN_KEY_DESK_CUTSCENE / SLOW:23-44
GOAL -> 23-44 = GOTO -> MEMORY:SARAH_CANT_KNOW_CYAN_DOOR_IS_OPENED, SLOW:21-44
GOAL -> 21-44 = GOTO -> FACING:UP, WAITING_BEFORE_HEADING_COMPUTER
$ -> WAITING_BEFORE_HEADING_COMPUTER = WAITFOR -> TIMER:2 ? FACING:LEFT, CREATE_DESK_KEY_ROOM_PATH_CHECKER, AFFECTING:INIT_DESK_KEY_ROOM_PATH_COMPUTER_CHECKER
! -> SARAH_WILL_GO_TO_COMPUTER_TO_TAKE_CYAN_KEY = GOTO -> FACING:DOWN, SLOW:20-42
GOAL -> 20-42 = GOTO -> FACING:RIGHT, WAITFOR_WILL_EXIT_JEAN_ROOM 
$ -> WAITFOR_WILL_EXIT_JEAN_ROOM = WAITFOR -> TIMER:3 ? MEMORY:SARAH_HAS_CYAN_KEY, SLOW:26-44
! -> TA_LISTEN_SARAH_JEAN_CONVERSATION = GOTO -> WAITFOR_NULL, TA_LISTEN_SARAH_JEAN_CONVERSATION
$ -> TA_LISTEN_SARAH_JEAN_CONVERSATION = GOTO -> ACTION_ONE:LISTEN*LISTEN_SARAH_JEAN_CONVERSATION, ACTION_TWO:NULL, CONDITIONNAL_ACTION_THREE
$ -> LISTEN_SARAH_JEAN_CONVERSATION = TALK -> SARAH_JEAN_CONVERSATION
TALKED -> SARAH_JEAN_CONVERSATION = AFFECTING -> A1_NULL_LISTEN_SARAH_JEAN_CONVERSATION
! -> A1_NULL_LISTEN_SARAH_JEAN_CONVERSATION = GOTO -> ACTION_ONE:NULL, CONDITIONNAL_ACTION_THREE
GOAL -> 32-44 = GOTO -> FACING:UP, TA_LISTEN_SARAH_DELTA_KEY_CONVERSATION, DISABLE_DELTA_WILL_ASKING_KEYS, WAITFOR_WILL_EXIT_DELTA_KEY_ROOM 
$ -> TA_LISTEN_SARAH_DELTA_KEY_CONVERSATION = TRIPLE_ACTION -> LISTEN*LISTEN_SARAH_DELTA_KEY_CONVERSATION
$ -> LISTEN_SARAH_DELTA_KEY_CONVERSATION = TALK -> SARAH_DELTA_KEY_CONVERSATION
$ -> WAITFOR_WILL_EXIT_DELTA_KEY_ROOM = WAITFOR -> TIMER:4 ? TA_NULL, ENABLE_DELTA_AFTER_ASKING_KEY, PLAYER_AVOIDER_TYPE:CUTSCENE, MEMORY:SARAH_HAS_CYAN_KEY, SLOW:26-44
$ -> DISABLE_DELTA_WILL_ASKING_KEYS = DISABLE -> 32-43:1
$ -> ENABLE_DELTA_AFTER_ASKING_KEY = ENABLE -> 32-43:1
GOAL -> 26-42 = GOTO -> PLAYER_AVOIDER_TYPE:AROUND, FACING:UP, WAITFOR_OPENING_FIRST_CYAN_DOOR

! -> ALICIA_MAYBE_HURTED = MEMORY -> ALICIA_ENCOUNTERED ? NULL / PARSE_ALICIA_MAYBE_HURTED_SARAH_ASKED
$ -> PARSE_ALICIA_MAYBE_HURTED_SARAH_ASKED = MEMORY -> ALICIA_MAYBE_HURTED_SARAH_ASKED ? NULL / PARSE_SARAH_ACTIVELY_ASKING_JEAN_ABOUT_KEYS
$ -> PARSE_SARAH_ACTIVELY_ASKING_JEAN_ABOUT_KEYS = MEMORY -> SARAH_ACTIVELY_ASKING_JEAN_ABOUT_KEYS ? PARSE_SARAH_ASKED_JEAN_ABOUT_KEYS_ALICIA / TA_ALICIA
$ -> PARSE_SARAH_ASKED_JEAN_ABOUT_KEYS_ALICIA = MEMORY -> SARAH_ASKED_JEAN_ABOUT_KEYS ? TA_ALICIA / PARSE_ALICIA_MAYBE_HURTED_JEAN_ASKED
$ -> PARSE_ALICIA_MAYBE_HURTED_JEAN_ASKED = MEMORY -> ALICIA_MAYBE_HURTED_JEAN_ASKED ? A3_ALICIA / A3_ALICIA_VAR
$ -> CONDITIONNAL_ACTION_THREE = MEMORY -> ALICIA_MAYBE_HURTED ? PARSE_ALICIA_ENCOUNTERED / NULL
$ -> PARSE_ALICIA_ENCOUNTERED = MEMORY -> ALICIA_ENCOUNTERED ? NULL / PARSE_ALICIA_MAYBE_HURTED_SARAH_ASKED
$ -> TA_ALICIA = GOTO -> ACTION_ONE:NULL, ACTION_THREE:ALICIA*TALK_SARAH_WHERE_IS_ALICIA
$ -> A3_ALICIA = ACTION_THREE -> ALICIA*TALK_SARAH_WHERE_IS_ALICIA
$ -> A3_ALICIA_VAR = ACTION_THREE -> ALICIA*TALK_SARAH_WHERE_IS_ALICIA_VAR
$ -> TALK_SARAH_WHERE_IS_ALICIA = TALK -> SARAH_WHERE_IS_ALICIA
$ -> TALK_SARAH_WHERE_IS_ALICIA_VAR = TALK -> SARAH_WHERE_IS_ALICIA_VAR
TALKED -> SARAH_WHERE_IS_ALICIA = GOTO -> MEMORY:ALICIA_MAYBE_HURTED_SARAH_ASKED
TALKED -> SARAH_WHERE_IS_ALICIA_VAR = GOTO -> MEMORY:ALICIA_MAYBE_HURTED_SARAH_ASKED, MEMORY:ALICIA_MAYBE_HURTED_JEAN_ASKED
TALKED -> JEAN_WHERE_IS_ALICIA_VAR = ACTION_THREE -> NULL

! -> SARAH_CYAN_KEY_DESK_CUTSCENE = GOTO -> CUTSCENE:START, EXPRESSION:EXCLAMATION, WAIFTOR_ASKING_REBECCAS_HELP_TO_FIND_KEYS
$ -> WAIFTOR_ASKING_REBECCAS_HELP_TO_FIND_KEYS = WAITFOR -> TIMER:2 ? PARSE_ALICIA_MAYBE_HURTED
$ -> PARSE_ALICIA_MAYBE_HURTED = MEMORY -> ALICIA_MAYBE_HURTED ? PARSE_ALICIA_MAYBE_HURTED_SARAH_ASKED_KEYS / TALK:SARAH_REBECCA_HELP_FOR_KEYS
$ -> PARSE_ALICIA_MAYBE_HURTED_SARAH_ASKED_KEYS = MEMORY -> ALICIA_MAYBE_HURTED_SARAH_ASKED ? TALK:SARAH_REBECCA_HELP_FOR_KEYS / TALK:SARAH_REBECCA_HELP_FOR_KEYS_ALICIA
TALKED -> SARAH_REBECCA_NO_KEYS = GOTO -> PLAYER_AVOIDER_TYPE:STOP, SLOW:32-44
TALKED -> SARAH_REBECCA_GIVING_KEYS = SLOW -> 26-42
TALKED -> SARAH_REBECCA_HELP_FOR_KEYS_ALICIA = GOTO -> MEMORY:ALICIA_MAYBE_HURTED_SARAH_ASKED, ACTION_THREE:NULL


//// INQUIRY FIRST CYAN DOOR ////

$ -> WAITFOR_OPENING_FIRST_CYAN_DOOR = WAITFOR -> TIMER:4 ? OPENING_FIRST_CYAN_DOOR, WAITFOR_SIDE_STEP_FROM_FIRST_CYAN_DOOR_CONDITIONNAL
$ -> OPENING_FIRST_CYAN_DOOR = GOTO -> SOUND:DOOR_UNLOCK, CREATE_FIRST_NULL_DOOR, DELETE_FIRST_CYAN_DOOR, AFFECTING:SARAH_OPENED_FIRST_CYAN_DOOR, MEMORY:SARAH_UNLOCKED_FIRST_CYAN_DOOR
$ -> CREATE_FIRST_NULL_DOOR = CREATE -> 26-41-FRONT:1-255-0
$ -> DELETE_FIRST_CYAN_DOOR = DELETE -> 26-41:1
$ -> WAITFOR_SIDE_STEP_FROM_FIRST_CYAN_DOOR_CONDITIONNAL = MEMORY -> SARAH_ASKED_JEAN_ABOUT_KEYS ? WAITFOR_SIDE_STEP_FROM_FIRST_CYAN_DOOR / NULL
$ -> WAITFOR_SIDE_STEP_FROM_FIRST_CYAN_DOOR = WAITFOR -> TIMER:1 ? SIDE_STEP_FROM_FIRST_CYAN_DOOR
$ -> SIDE_STEP_FROM_FIRST_CYAN_DOOR = MEMORY -> JEAN_WAITING_FUTHER_SARAH_TO_OPEN ? BACKUP_FIRST_CYAN_DOOR_B / BACKUP_FIRST_CYAN_DOOR_A
$ -> BACKUP_FIRST_CYAN_DOOR_A = SLOW_BACKUP -> 27-42, 26-43
$ -> BACKUP_FIRST_CYAN_DOOR_B = SLOW_BACKUP -> 27-42, 25-42
GOAL -> 27-42 = GOTO -> FACING:LEFT, MEMORY:JEAN_PUSH_DOWN
GOAL -> 26-43 = FACING -> UP
GOAL -> 25-42 = GOTO -> FACING:RIGHT, MEMORY:JEAN_PUSH_RIGHT
! -> JEAN_REACHED_MIDDLE_OF_CORRIDOR = MEMORY -> SCENARIO_INQUIRY ? MEMORY:ALICIA_MAYBE_HURTED_SARAH_ASKED, TA_NULL, PARSE_JEAN_PUSHED_SARAH / MEMORY:ALICIA_MAYBE_HURTED_SARAH_ASKED, TA_NULL
$ -> PARSE_JEAN_PUSHED_SARAH = MEMORY -> JEAN_PUSHED_SARAH ? SARAH_ANGRY_AGAINST_JEAN_CONDITIONNAL / SARAH_ANGRY_AGAINST_JEAN_FOR_ANOTHER_REASON_CONDITIONNAL
$ -> SARAH_ANGRY_AGAINST_JEAN_FOR_ANOTHER_REASON_CONDITIONNAL = MEMORY -> JEAN_PUSHED_PLAYER_IN_FRONT_OF_SARAH ? TALK:SARAH_ANGRY_AGAINST_JEAN / PARSE_SARAH_CANT_KNOW_CYAN_DOOR_IS_OPENED
$ -> PARSE_SARAH_CANT_KNOW_CYAN_DOOR_IS_OPENED = MEMORY -> SARAH_CANT_KNOW_CYAN_DOOR_IS_OPENED ? PARSE_SARAH_UNLOCKED_FIRST_CYAN_DOOR / PLAYER_AVOIDER_TYPE:STOP, SLOW:26-39
$ -> PARSE_SARAH_UNLOCKED_FIRST_CYAN_DOOR = MEMORY -> SARAH_UNLOCKED_FIRST_CYAN_DOOR ? PLAYER_AVOIDER_TYPE:STOP, SLOW:26-39 / MEMORY:SARAH_WILL_NOTICE_DOOR_IS_OPENED
$ -> SARAH_ANGRY_AGAINST_JEAN_CONDITIONNAL = PLAYER_CLOSER_THAN -> 7 ? TALK:SARAH_ANGRY_AGAINST_JEAN / PLAYER_AVOIDER_TYPE:AROUND, MOVE:26-39

PUSHED -> REBECCA = MEMORY -> JEAN_MAY_PUSH_PLAYER_IN_FRONT_OF_SARAH ? PARSE_STOPPING_JEAN_MAY_PUSH_PLAYER_IN_FRONT_OF_SARAH / CHECK_SARAH_SEEING_JEAN_PUSHING_REBECCA
$ -> PARSE_STOPPING_JEAN_MAY_PUSH_PLAYER_IN_FRONT_OF_SARAH = MEMORY -> STOPPING_JEAN_MAY_PUSH_PLAYER_IN_FRONT_OF_SARAH ? CHECK_SARAH_SEEING_JEAN_PUSHING_REBECCA / MEMORY:JEAN_PUSHED_PLAYER_IN_FRONT_OF_SARAH
$ -> CHECK_SARAH_SEEING_JEAN_PUSHING_REBECCA = SEE -> JEAN ? CHECK_SARAH_SEEING_JEAN_PUSHING_REBECCA_SECOND_VERIFICATION / NULL
$ -> CHECK_SARAH_SEEING_JEAN_PUSHING_REBECCA_SECOND_VERIFICATION = PLAYER_CLOSER_THAN -> 6 ? MEMORY:JEAN_PUSHED_PLAYER_IN_FRONT_OF_SARAH, MOVE:STOP, FACING:JEAN, WAITFOR_NULL / NULL
TALKED -> SARAH_ANGRY_AGAINST_JEAN = GOTO -> PLAYER_AVOIDER_TYPE:AROUND, MOVE:26-39, MEMORY:SARAH_ANGRY_AGAINST_JEAN
GOAL -> 26-39 = GOTO -> PARSE_SARAH_ANGRY_AGAINST_JEAN, TA_NULL
$ -> PARSE_SARAH_ANGRY_AGAINST_JEAN = MEMORY -> SARAH_ANGRY_AGAINST_JEAN ? MOVE:16-35 / SLOW:16-35


//// INQUIRY LEFT AREA ////