TIME -> 0 = GOTO -> NAME:MARIE, CONDITION:SIT, HITBOX_COUCH, PLAYER_AVOIDER_TYPE:AROUND_OMNISCIENT


//// STATE ////

$ -> UNSIT_FROM_COUCH = GOTO -> HITBOX_NORMAL, CONDITION:GOOD, SOUND_IF_CAMERA:JUMP, TP:13-30, AFFECTING:OBJ-38*BLOCKING_HORIZONTAL_COUCH_TRUE
$ -> MARIE_GOING_ON_SEAT = GOTO -> DISPLAY_TOILET, CONDITION:SIT, SOUND_IF_CAMERA:JUMP, FACING:LEFT
$ -> MARIE_EXIT_SEAT = GOTO -> DISPLAY_NORMAL, CONDITION:GOOD, SOUND_IF_CAMERA:TOILET_FLUSH
$ -> HITBOX_NORMAL = HITBOX -> 0, 0, 16, 16
$ -> HITBOX_COUCH = HITBOX -> 0, 2, 16, 17
$ -> HITBOX_AWAY_FROM_JOSEPH = HITBOX -> 0, 0, 24, 16
$ -> DISPLAY_NORMAL = DISPLAY -> 0, 0
$ -> DISPLAY_AWAY_FROM_JOSEPH = DISPLAY -> 4, 0
$ -> DISPLAY_TOILET = DISPLAY -> 16, -2
$ -> DISPLAY_SINK = DISPLAY -> 0, -14
$ -> WAITFOR_NULL = WAITFOR -> NULL


//// PLAYERLESS BEHAVIOR ////

TIME -> 1 = TP -> 13-29
! -> MARIE_THINKING_ABOUT_COFFEE = WAITFOR -> TIMER:20 ? UNSIT_FROM_COUCH, SLOW:7-29
GOAL -> 7-29 = GOTO -> FACING:UP, SOUND_IF_CAMERA:COFFEE_MACHINE, WAITFOR_HEADING_JOSEPH
$ -> WAITFOR_HEADING_JOSEPH = WAITFOR -> TIMER:5 ? CONDITION:CUP, SLOW:10-31
GOAL -> 10-31 = GOTO -> FACING:LEFT, HITBOX_AWAY_FROM_JOSEPH, DISPLAY_AWAY_FROM_JOSEPH, WAITFOR_DRINKING_COFFEE
$ -> WAITFOR_DRINKING_COFFEE = WAITFOR -> TIMER:30 ? CONDITION:GOOD, SOUND_IF_CAMERA:DRINK_JUICE, WAITFOR_HEADING_BATHROOM
$ -> WAITFOR_HEADING_BATHROOM = WAITFOR -> TIMER:20 ? AFFECTING:JOSEPH*JOSEPH_FEELS_SLEEPY, HITBOX_NORMAL, DISPLAY_NORMAL, HEADING_BATHROOM_ENTRANCE
$ -> HEADING_BATHROOM_ENTRANCE = SLOW_BACKUP -> 16-30, 14-28
GOAL -> 16-30 = GOTO -> FACING:UP, HEADING_BATHROOM
GOAL -> 14-28 = GOTO -> FACING:RIGHT, HEADING_BATHROOM
$ -> HEADING_BATHROOM = GOTO -> PLAYER_AVOIDER_TYPE:AROUND, SLOW:21-26
GOAL -> 21-26 = GOTO -> FACING:LEFT, WAITING_BEFORE_LOCKING_TOILET
$ -> WAITING_BEFORE_LOCKING_TOILET = WAITFOR -> TIMER:1 ? PARSE_REBECCA_PRESENCE_IN_TOILET
$ -> PARSE_REBECCA_PRESENCE_IN_TOILET = SEE -> PLAYER ? WAITING_BEING_ALONE_IN_TOILET / ALONE_IN_TOILET
$ -> WAITING_BEING_ALONE_IN_TOILET = WAITFOR -> PLAYER_FUTHER_THAN:2 ? ALONE_IN_TOILET
$ -> ALONE_IN_TOILET = GOTO -> LOCK_TOILET_DOOR, SOUND_IF_CAMERA:DOOR_UNLOCK, WAITING_BEFORE_GOING_FOR_TOILET_SEAT
$ -> LOCK_TOILET_DOOR = CREATE -> 20-26-FRONT:1-235-6
$ -> UNLOCK_TOILET_DOOR = DELETE -> 20-26:WORLD,3
$ -> WAITING_BEFORE_GOING_FOR_TOILET_SEAT = WAITFOR -> TIMER:1 ? MARIE_GOING_ON_SEAT, WAITING_BEFORE_DOING_STUFF
$ -> WAITING_BEFORE_DOING_STUFF = WAITFOR -> TIMER:2 ? SOUND_IF_CAMERA:TOILET_DOING, WAITING_BEFORE_FINISHED
$ -> WAITING_BEFORE_FINISHED = WAITFOR -> TIMER:3 ? MARIE_EXIT_SEAT, WAITING_BEFORE_UNLOCKING_TOILET
$ -> WAITING_BEFORE_UNLOCKING_TOILET = WAITFOR -> TIMER:1 ? PARSE_TOILET_DOOR_SABOTAGED
$ -> EXIT_TOILET = GOTO -> DELETE_PIRANHA_TOILET_DOOR, UNLOCK_TOILET_DOOR, SOUND_IF_CAMERA:DOOR_UNLOCK, WAITING_BEFORE_GOING_TO_SINK
$ -> WAITING_BEFORE_GOING_TO_SINK = WAITFOR -> TIMER:1 ? SLOW:17-25
GOAL -> 17-25 = GOTO -> DISPLAY_SINK, FACING:UP, SOUND_IF_CAMERA:WATER_SINK, WAITING_BEFORE_CLEANED
$ -> WAITING_BEFORE_CLEANED = WAITFOR -> TIMER:2 ? DISPLAY_NORMAL, SLOW:18-24
GOAL -> 18-24 = GOTO -> FACING:UP, SOUND_IF_CAMERA:TOILET_HAND_DRYER, WAITING_BEFORE_DRY
$ -> WAITING_BEFORE_DRY = WAITFOR -> TIMER:3 ? PLAYER_AVOIDER_TYPE:AROUND_OMNISCIENT, SLOW:16-35


//// TOILET LOCKED UP ////

$ -> PARSE_TOILET_DOOR_SABOTAGED = MEMORY -> TOILET_DOOR_SABOTAGED ? SOUND_IF_CAMERA:DOOR_OPEN, WAITFOR_TOILET_SUSPENSION / EXIT_TOILET
$ -> DELETE_PIRANHA_TOILET_DOOR = DELETE -> 20-26:WORLD,1
$ -> WAITFOR_TOILET_SUSPENSION = WAITFOR -> TIMER:1 ? EXPRESSION:SUSPENSION, WAITFOR_CRAZY_TOILET_SOUND
$ -> WAITFOR_CRAZY_TOILET_SOUND = WAITFOR -> TIMER:2 ? SOUND_IF_CAMERA:DOOR_CRAZY_OPEN, WAITFOR_TOILET_SUSPENSION_AGAIN
$ -> WAITFOR_TOILET_SUSPENSION_AGAIN = WAITFOR -> TIMER:4 ? EXPRESSION:SUSPENSION, WAITFOR_TOILET_FACING_DOWN
$ -> WAITFOR_TOILET_FACING_DOWN = WAITFOR -> TIMER:3 ? FACING:DOWN, WAITFOR_TOILET_FACING_LEFT
$ -> WAITFOR_TOILET_FACING_LEFT = WAITFOR -> TIMER:3 ? FACING:LEFT, WAITFOR_TOILET_LAST_TRY
$ -> WAITFOR_TOILET_LAST_TRY = WAITFOR -> TIMER:2 ? SOUND_IF_CAMERA:DOOR_OPEN, WAITFOR_CRYING_IN_TOILET
$ -> WAITFOR_CRYING_IN_TOILET = WAITFOR -> TIMER:2 ? CONDITION:CRY, MEMORY:MARIE_CRYING, AFFECTING:SET-UP*ACHIEVEMENT_CRYING


//// EXIT ////

! -> SCENARIO_EXIT = TRIPLE_ACTION -> TALK*MARIE_EXIT
TALKED -> MARIE_EXIT = UNLOCKEDTOOL -> BOMB:CYAN ? TALK:MARIE_BOMB / TALK:MARIE_NO_BOMB
TALKED -> MARIE_BOMB = GOTO -> A1_MARIE_INTRUDER
TALKED -> MARIE_NO_BOMB = GOTO -> A1_MARIE_INTRUDER
$ -> A1_MARIE_INTRUDER = ACTION_ONE -> TALK*MARIE_INTRUDER
TALKED -> MARIE_INTRUDER = GOTO -> WAITFOR_NULL, SLOW:16-35, UNSIT_CONDITIONNAL
$ -> UNSIT_CONDITIONNAL = CONDITION -> SIT ? UNSIT_FROM_COUCH / DRINK_CONDITIONNAL
$ -> DRINK_CONDITIONNAL = CONDITION -> CUP ? CONDITION:GOOD, SOUND:DRINK_JUICE / NULL

GOAL -> 16-35 = GOTO -> PLAYER_AVOIDER_TYPE:STOP, SLOW:26-43
GOAL -> 32-44 = GOTO -> STUFF