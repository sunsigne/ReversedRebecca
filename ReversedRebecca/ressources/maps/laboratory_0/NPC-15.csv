TIME -> 0 = GOTO -> NAME:MARIE, CONDITION:SIT, HITBOX_COUCH, PLAYER_AVOIDER_TYPE:AROUND_OMNISCIENT


//// STATE ////

$ -> TA_NULL = TRIPLE_ACTION -> NULL
$ -> UNSIT_FROM_COUCH = GOTO -> HITBOX_NORMAL, CONDITION:GOOD, SOUND_IF_CAMERA:JUMP, TP:13-30, AFFECTING:OBJ-38*BLOCKING_HORIZONTAL_COUCH_TRUE
$ -> MARIE_GOING_ON_SEAT = GOTO -> DISPLAY_TOILET, CONDITION:SIT, SOUND_IF_CAMERA:JUMP, FACING:LEFT
$ -> MARIE_EXIT_SEAT = GOTO -> DISPLAY_NORMAL, CONDITION:GOOD, SOUND_IF_CAMERA:TOILET_FLUSH
$ -> HITBOX_NORMAL = HITBOX -> 0, 0, 16, 16
$ -> HITBOX_COUCH = HITBOX -> 0, 2, 16, 17
$ -> HITBOX_UP_PEE_PUDDLE_ILLUSION = HITBOX -> -16, 0, 16, 16
$ -> HITBOX_AWAY_FROM_JOSEPH = HITBOX -> 0, 0, 24, 16
$ -> DISPLAY_NORMAL = DISPLAY -> 0, 0
$ -> DISPLAY_AWAY_FROM_JOSEPH = DISPLAY -> 4, 0
$ -> DISPLAY_TOILET = DISPLAY -> 16, -2
$ -> DISPLAY_SINK = DISPLAY -> 0, -14
$ -> WAITFOR_NULL = WAITFOR -> NULL
$ -> UP_PEE_PUDDLE_ILLUSION = GOTO -> TP:20-24, HITBOX_UP_PEE_PUDDLE_ILLUSION, DISPLAY_UP_PEE_PUDDLE_ILLUSION
$ -> DISABLE_UP_PEE_PUDDLE_ILLUSION = GOTO -> DISPLAY_NORMAL, HITBOX_NORMAL, TP:19-24 
$ -> DISPLAY_UP_PEE_PUDDLE_ILLUSION = DISPLAY -> -16, 0
! -> ALICIA_FOLLOW_PLAYER = GOTO -> MEMORY:MARIE_WONT_REACT_TO_REBECCA_PRESENCE_ANYMORE, ACTION_THREE:NULL


//// PLAYERLESS BEHAVIOR ////

TIME -> 1 = TP -> 13-29
! -> MARIE_THINKING_ABOUT_COFFEE = CONDITION -> SIT ? MARIE_THINKING_ABOUT_COFFEE / NULL
$ -> MARIE_THINKING_ABOUT_COFFEE = WAITFOR -> TIMER:20 ? UNSIT_FROM_COUCH, SLOW:7-29
GOAL -> 7-29 = GOTO -> FACING:UP, SOUND_IF_CAMERA:COFFEE_MACHINE, WAITFOR_HEADING_JOSEPH
$ -> WAITFOR_HEADING_JOSEPH = WAITFOR -> TIMER:5 ? CONDITION:CUP, SLOW:10-31
GOAL -> 10-31 = GOTO -> FACING:LEFT, HITBOX_AWAY_FROM_JOSEPH, DISPLAY_AWAY_FROM_JOSEPH, WAITFOR_DRINKING_COFFEE, CHATTING_WITH_JOSEPH
$ -> WAITFOR_DRINKING_COFFEE = WAITFOR -> TIMER:30 ? CONDITION:GOOD, SOUND_IF_CAMERA:DRINK_JUICE, WAITFOR_HEADING_BATHROOM
$ -> WAITFOR_HEADING_BATHROOM = WAITFOR -> TIMER:20 ? PRE_HEADING_BATHROOM
$ -> PRE_HEADING_BATHROOM = GOTO -> AFFECTING:JOSEPH*JOSEPH_FEELS_SLEEPY, HITBOX_NORMAL, DISPLAY_NORMAL, AFFECTING:JOSEPH*TA_STOP_MARIE_JOSEPH_TALK, SAVED_TRIPLE_ACTION:LOAD, HEADING_BATHROOM_ENTRANCE
$ -> HEADING_BATHROOM_ENTRANCE = SLOW_BACKUP -> 16-30, 14-28
GOAL -> 16-30 = GOTO -> FACING:UP, HEADING_BATHROOM, SAVED_TRIPLE_ACTION:SAVE, TA_NULL
GOAL -> 14-28 = GOTO -> FACING:RIGHT, HEADING_BATHROOM, SAVED_TRIPLE_ACTION:SAVE, TA_NULL
$ -> HEADING_BATHROOM = GOTO -> PLAYER_AVOIDER_TYPE:CUTSCENE, SLOW:16-26
GOAL -> 16-26 = GOTO -> FACING:RIGHT, MARIE_SEE_PLAYER_IN_BATHROOM_CONDITIONNAL, PARSE_MARIE_SEE_PLAYER_IN_BATHROOM
$ -> MARIE_SEE_PLAYER_IN_BATHROOM_CONDITIONNAL = SEE -> PLAYER ? MEMORY:MARIE_SEE_PLAYER_IN_BATHROOM / NULL
$ -> PARSE_MARIE_SEE_PLAYER_IN_BATHROOM = MEMORY -> MARIE_SEE_PLAYER_IN_BATHROOM ? SLOW_BATHROOM / LOOP_PARSE_MARIE_SEE_PLAYER_IN_BATHROOM, SLOW:20-26
$ -> LOOP_PARSE_MARIE_SEE_PLAYER_IN_BATHROOM = WAITFOR -> TIMER:1 ? MARIE_SEE_PLAYER_IN_BATHROOM_CONDITIONNAL, PARSE_MARIE_SEE_PLAYER_IN_BATHROOM
$ -> SLOW_BATHROOM = SLOW_BACKUP -> 20-26, 19-24
GOAL -> 20-24 = GOTO -> FACING:PLAYER, MEMORY:MARIE_SORRY_IN_UP_TOILET, PARSE_FACING_IN_TOILET
GOAL -> 20-26 = GOTO -> FACING:PLAYER, PARSE_FACING_IN_TOILET
$ -> PARSE_FACING_IN_TOILET = FACING -> RIGHT ? DOUBLE_VERIFICATION_PARSE_FACING_IN_TOILET / PARSE_MARIE_SORRY_IN_UP_TOILET
$ -> DOUBLE_VERIFICATION_PARSE_FACING_IN_TOILET = SEE -> PLAYER ? TALK:MARIE_SORRY / PARSE_MARIE_SORRY_IN_UP_TOILET
TALKED -> MARIE_SORRY = MEMORY -> MARIE_SORRY_IN_UP_TOILET ? SLOW:21-26 / SLOW: 19-24
$ -> PARSE_MARIE_SORRY_IN_UP_TOILET = MEMORY -> MARIE_SORRY_IN_UP_TOILET ? SLOW:19-24 / SLOW:21-26
GOAL -> 19-24 = MEMORY -> PLAYER_PISSED_ON ? SEE_TOILET_PEE_PUDDLE / SLOW:21-24
$ -> SEE_TOILET_PEE_PUDDLE = GOTO -> FACING:RIGHT, EXPRESSION:SUSPENSION, UP_PEE_PUDDLE_ILLUSION, WAITFOR_HEADING_WAITING_SPOT_FOR_REBECCA_TO_FINISH_IN_TOILET,
$ -> WAITFOR_HEADING_WAITING_SPOT_FOR_REBECCA_TO_FINISH_IN_TOILET = WAITFOR -> TIMER:2 ? DISABLE_UP_PEE_PUDDLE_ILLUSION, SLOW:18-25
GOAL -> 18-25 = GOTO -> FACING:RIGHT, PLAYER_AVOIDER_TYPE:STOP, WAITFOR_OUTSIDE_OF_TOILET
$ -> WAITFOR_OUTSIDE_OF_TOILET = WAITFOR -> PLAYER_FUTHER_THAN:5 ? SLOW:21-26
GOAL -> 21-24 = GOTO -> MEMORY:MARIE_WENT_TO_UP_TOILET, FACING:LEFT, WAITING_BEFORE_LOCKING_TOILET_UP
GOAL -> 21-26 = GOTO -> FACING:LEFT, WAITING_BEFORE_LOCKING_TOILET
$ -> WAITING_BEFORE_LOCKING_TOILET_UP = WAITFOR -> TIMER:1 ? PARSE_REBECCA_PRESENCE_IN_TOILET_UP
$ -> PARSE_REBECCA_PRESENCE_IN_TOILET_UP = SEE -> PLAYER ? WAITING_BEING_ALONE_IN_TOILET_UP / ALONE_IN_TOILET_UP
$ -> WAITING_BEING_ALONE_IN_TOILET_UP = WAITFOR -> PLAYER_FUTHER_THAN:2 ? ALONE_IN_TOILET_UP
$ -> WAITING_BEFORE_LOCKING_TOILET = WAITFOR -> TIMER:1 ? PARSE_REBECCA_PRESENCE_IN_TOILET
$ -> PARSE_REBECCA_PRESENCE_IN_TOILET = SEE -> PLAYER ? WAITING_BEING_ALONE_IN_TOILET / ALONE_IN_TOILET
$ -> WAITING_BEING_ALONE_IN_TOILET = WAITFOR -> PLAYER_FUTHER_THAN:2 ? ALONE_IN_TOILET
$ -> ALONE_IN_TOILET_UP = GOTO -> LOCK_TOILET_DOOR_UP, LOCK_TOILET_DOOR_UP_ANIMATION, SOUND_IF_CAMERA:DOOR_UNLOCK, WAITING_BEFORE_GOING_FOR_TOILET_SEAT
$ -> ALONE_IN_TOILET = GOTO -> LOCK_TOILET_DOOR, LOCK_TOILET_DOOR_ANIMATION, SOUND_IF_CAMERA:DOOR_UNLOCK, WAITING_BEFORE_GOING_FOR_TOILET_SEAT
$ -> LOCK_TOILET_DOOR_UP_ANIMATION = CREATE -> 20-24-FRONT:1-128-2
$ -> LOCK_TOILET_DOOR_UP = CREATE -> 20-24-FRONT:1-235-6
$ -> LOCK_TOILET_DOOR_ANIMATION = CREATE -> 20-26-FRONT:1-128-2
$ -> LOCK_TOILET_DOOR = CREATE -> 20-26-FRONT:1-235-6
$ -> UNLOCK_TOILET_DOOR_UP_ANIMATION = CREATE -> 20-24-FRONT:1-128-1
$ -> UNLOCK_TOILET_DOOR_UP = DELETE -> 20-24:WORLD,3
$ -> UNLOCK_TOILET_DOOR_ANIMATION = CREATE -> 20-26-FRONT:1-128-1
$ -> UNLOCK_TOILET_DOOR = DELETE -> 20-26:WORLD,3
$ -> WAITING_BEFORE_GOING_FOR_TOILET_SEAT = WAITFOR -> TIMER:1 ? MARIE_GOING_ON_SEAT, WAITING_BEFORE_DOING_STUFF
$ -> WAITING_BEFORE_DOING_STUFF = WAITFOR -> TIMER:2 ? SOUND_IF_CAMERA:TOILET_DOING, WAITING_BEFORE_FINISHED
$ -> WAITING_BEFORE_FINISHED = WAITFOR -> TIMER:3 ? MARIE_EXIT_SEAT, WAITING_BEFORE_UNLOCKING_TOILET
$ -> WAITING_BEFORE_UNLOCKING_TOILET = WAITFOR -> TIMER:1 ? PARSE_MARIE_WENT_TO_UP_TOILET
$ -> PARSE_MARIE_WENT_TO_UP_TOILET = MEMORY -> MARIE_WENT_TO_UP_TOILET ? EXIT_TOILET_UP / PARSE_TOILET_DOOR_SABOTAGED
$ -> EXIT_TOILET_UP = GOTO -> UNLOCK_TOILET_DOOR_UP, UNLOCK_TOILET_DOOR_UP_ANIMATION, SOUND_IF_CAMERA:DOOR_UNLOCK, WAITING_BEFORE_GOING_TO_SINK
$ -> EXIT_TOILET = GOTO -> UNLOCK_TOILET_DOOR, UNLOCK_TOILET_DOOR_ANIMATION, SOUND_IF_CAMERA:DOOR_UNLOCK, WAITING_BEFORE_GOING_TO_SINK
$ -> WAITING_BEFORE_GOING_TO_SINK = WAITFOR -> TIMER:1 ? SLOW:17-25
GOAL -> 17-25 = GOTO -> DISPLAY_SINK, FACING:UP, SOUND_IF_CAMERA:WATER_SINK, WAITING_BEFORE_CLEANED
$ -> WAITING_BEFORE_CLEANED = WAITFOR -> TIMER:2 ? DISPLAY_NORMAL, SLOW:18-24
GOAL -> 18-24 = GOTO -> FACING:UP, SOUND_IF_CAMERA:TOILET_HAND_DRYER, WAITING_BEFORE_DRY
$ -> WAITING_BEFORE_DRY = WAITFOR -> TIMER:3 ? PLAYER_AVOIDER_TYPE:AROUND_OMNISCIENT, SLOW:16-27
GOAL -> 16-27 = GOTO -> SAVED_TRIPLE_ACTION:LOAD, SLOW:16-35


//// JOSEPH MARIE ////

$ -> CHATTING_WITH_JOSEPH = GOTO -> SAVED_TRIPLE_ACTION:SAVE, AFFECTING:JOSEPH*TA_MARIE_JOSEPH_TALK, TA_MARIE_JOSEPH_TALK
$ -> TA_MARIE_JOSEPH_TALK = TRIPLE_ACTION -> CUSTOM(LISTEN)TALK_MARIE_JOSEPH_TALK
$ -> TALK_MARIE_JOSEPH_TALK = GOTO -> AFFECTING:SET-UP*ADD_COUNTER_TWO, TALK:MARIE_JOSEPH_TALK

TALKED -> JOSEPH_CRYING_ALICIA_REACTION*SPONTANEOUS = GOTO -> WAITFOR_NULL, MOVE:STOP
TALKED -> JOSEPH_CRYING_ALICIA_REACTION*SPONTANEOUS_VAR = GOTO -> WAITFOR_NULL, MOVE:STOP
TALKED -> JOSEPH*OFFER_A_TEA_BAD = MEMORY -> ALICIA_FOLLOW_PLAYER ? NULL / PARSE_ALICIA_FREED_FROM_SAS
$ -> PARSE_ALICIA_FREED_FROM_SAS = MEMORY -> ALICIA_FREED_FROM_SAS ? NULL / PARSE_JOSEPH_OFFER_A_TEA_BAD
$ -> PARSE_JOSEPH_OFFER_A_TEA_BAD = SEE -> PLAYER ? MOVE:STOP, TALK:JOSEPH_CRYING_MARIE_REACTION*SPONTANEOUS / NULL
TALKED -> JOSEPH_CRYING_MARIE_REACTION*SPONTANEOUS = GOTO -> WAITFOR_HEADING_INVENTORY_FROM_JOSEPH, ACTION_ONE:TALK(TALK)JOSEPH_CRYING_MARIE_REACTION*WHEN_TALKED
$ -> WAITFOR_HEADING_INVENTORY_FROM_JOSEPH = WAITFOR -> TIMER:5 ? UNSIT_CONDITIONNAL, MEMORY:TA_INVENTORY, MEMORY:MARIE_WONT_REACT_TO_REBECCA_PRESENCE_ANYMORE, GO_INVENTORY


//// TOILET LOCKED UP ////

$ -> PARSE_TOILET_DOOR_SABOTAGED = MEMORY -> TOILET_DOOR_SABOTAGED ? SOUND_IF_CAMERA:DOOR_OPEN, WAITFOR_TOILET_SUSPENSION / EXIT_TOILET
$ -> WAITFOR_TOILET_SUSPENSION = WAITFOR -> TIMER:1 ? EXPRESSION:SUSPENSION, WAITFOR_CRAZY_TOILET_SOUND
$ -> WAITFOR_CRAZY_TOILET_SOUND = WAITFOR -> TIMER:2 ? SOUND_IF_CAMERA:DOOR_CRAZY_OPEN, WAITFOR_TOILET_SUSPENSION_AGAIN
$ -> WAITFOR_TOILET_SUSPENSION_AGAIN = WAITFOR -> TIMER:4 ? EXPRESSION:SUSPENSION, WAITFOR_TOILET_FACING_DOWN
$ -> WAITFOR_TOILET_FACING_DOWN = WAITFOR -> TIMER:3 ? FACING:DOWN, WAITFOR_TOILET_FACING_LEFT
$ -> WAITFOR_TOILET_FACING_LEFT = WAITFOR -> TIMER:3 ? FACING:LEFT, WAITFOR_TOILET_LAST_TRY
$ -> WAITFOR_TOILET_LAST_TRY = WAITFOR -> TIMER:2 ? SOUND_IF_CAMERA:DOOR_OPEN, WAITFOR_CRYING_IN_TOILET
$ -> WAITFOR_CRYING_IN_TOILET = WAITFOR -> TIMER:2 ? CONDITION:CRY, MEMORY:SARAH_CAN_AHEAD_ALICIA_DESK


//// EXIT ////

! -> SCENARIO_EXIT = GOTO -> TA_INIT
$ -> TA_INIT = TRIPLE_ACTION -> CUSTOM(TALK)TALK_MARIE_EXIT_CONDITIONAL_ALICIA
$ -> TALK_MARIE_EXIT_CONDITIONAL_ALICIA = MEMORY -> ALICIA_FOLLOW_PLAYER ? AFFECTING:ALICIA*TP_TO_PLAYER, TALK:MARIE_EXIT*HELLO / TALK:MARIE_EXIT*HELLO
TALKED -> MARIE_EXIT*HELLO = UNLOCKEDTOOL -> BOMB:CYAN ? TALK:MARIE_EXIT*BOMB / TALK:MARIE_EXIT*NO_BOMB
TALKED -> MARIE_EXIT*BOMB = GOTO -> MEMORY:MARIE_MET, A1_MARIE_INTRUDER
TALKED -> MARIE_EXIT*NO_BOMB = GOTO -> MEMORY:MARIE_MET, A1_MARIE_INTRUDER
$ -> A1_MARIE_INTRUDER = ACTION_ONE -> TALK(INTRUDER)MARIE_EXIT*INTRUDER
TALKED -> MARIE_EXIT*INTRUDER = MEMORY -> SARAH_ANGRY_AGAINST_JEAN ? TALK_MARIE_INTRUDER_SARAH_PISSED / PARSE_SARAH_ANGRY_REALLY_HARD
TALKED -> PARSE_SARAH_ANGRY_REALLY_HARD = MEMORY -> SARAH_ANGRY_REALLY_HARD ? TALK:MARIE_EXIT*INTRUDER_SARAH_PISSED_VAR / TALK:MARIE_EXIT*INTRUDER_NEXT
$ -> TALK_MARIE_INTRUDER_SARAH_PISSED = MEMORY -> ALICIA_FOLLOW_PLAYER ? AFFECTING:ALICIA*TP_TO_PLAYER, TALK:MARIE_EXIT*INTRUDER_SARAH_PISSED / TALK:MARIE_EXIT*INTRUDER_SARAH_PISSED
TALKED -> MARIE_EXIT*INTRUDER_NEXT = GOTO -> WAITFOR_NULL, SLOW:16-34, UNSIT_CONDITIONNAL
$ -> UNSIT_CONDITIONNAL = CONDITION -> SIT ? UNSIT_FROM_COUCH / DRINK_CONDITIONNAL
$ -> DRINK_CONDITIONNAL = CONDITION -> CUP ? CONDITION:GOOD, SOUND:DRINK_JUICE / NULL
GOAL -> 16-34 = GOTO -> PLAYER_AVOIDER_TYPE:STOP, SLOW:16-39
GOAL -> 16-39 = SLOW -> 26-44
GOAL -> 26-44 = MEMORY -> MARIE_ALREADY_CLEANED_PEE_PUDDLE ? SLOW:32-44 / PARSE_MARIE_WILL_CLEAN_PEE_PUDDLE
$ -> PARSE_MARIE_WILL_CLEAN_PEE_PUDDLE = MEMORY -> MARIE_WILL_CLEAN_PEE_PUDDLE ? SLOW:26-46 / PARSE_PEEING_HIMSELF
$ ->  PARSE_PEEING_HIMSELF = MEMORY -> PEEING_HIMSELF ? SEE_PEE_PUDDLE_FROM_FAR / SLOW:32-44
$ -> SEE_PEE_PUDDLE_FROM_FAR = GOTO -> MOVE:STOP, PLAYER_AVOIDER_TYPE:CUTSCENE, EXPRESSION:EXCLAMATION, WAITFOR_COME_CLOSER_FROM_PEE_PUDDLE
$ -> WAITFOR_COME_CLOSER_FROM_PEE_PUDDLE = WAITFOR -> TIMER:2 ? SLOW:26-46
$ -> SEE_PEE_PUDDLE = GOTO -> MOVE:STOP, FACING:LEFT, EXPRESSION:SUSPENSION, MEMORY:MARIE_WILL_CLEAN_PEE_PUDDLE, WAITFOR_GO_TAKE_SWEEPER
$ -> WAITFOR_GO_TAKE_SWEEPER = WAITFOR -> TIMER:3 ? SLOW:16-25
GOAL -> 16-25 = GOTO -> DISPLAY_SINK, SOUND_IF_CAMERA:WATER_SINK, WAITFOR_GO_PUDDLE_PLACE
$ -> WAITFOR_GO_PUDDLE_PLACE = WAITFOR -> TIMER:4 ? DISPLAY_NORMAL, SLOW:26-44
GOAL -> 26-46 = MEMORY -> MARIE_WILL_CLEAN_PEE_PUDDLE ? PLAYER_AVOIDER_TYPE:STOP, CLEAN_PUDDLE / PLAYER_AVOIDER_TYPE:STOP, SEE_PEE_PUDDLE
$ -> CLEAN_PUDDLE = GOTO -> CREATE_CLEANING_ANIMATION, TP:35-65, CREATE_WALL, AFFECTING:PEEPUDDLE*START_CLEANING
! -> FINISHED_CLEAN_PUDDLE = GOTO -> DELETE_WALL, DELETE_CLEANING_ANIMATION, TP:26-46, SLOW:16-25, MEMORY:MARIE_ALREADY_CLEANED_PEE_PUDDLE, AFFECTING:JEAN*DELETE_PEE_PUDDLE
$ -> CREATE_CLEANING_ANIMATION = CREATE_ANIMATION -> 25-46-BACK:WORLD,2,1,MARIE_SWEEPING,60,TRUE
$ -> DELETE_CLEANING_ANIMATION = DELETE -> 25-46:WORLD,1
$ -> CREATE_WALL = CREATE -> 26-46-BACK:255-255-255
$ -> DELETE_WALL = DELETE -> 26-46:WORLD,1

GOAL -> 32-44 = GOTO -> FACING:UP, PLAYER_AVOIDER_TYPE:CUTSCENE, MARIE_SARAH_DELTA_CONVERSATION, WAITFOR_STOP_MARIE_SARAH_DELTA_CONVERSATION
$ -> MARIE_SARAH_DELTA_CONVERSATION = GOTO -> AFFECTING:A1_LISTEN_MARIE_SARAH_DELTA, ACTION_ONE:CUSTOM(LISTEN)LISTEN_MARIE_SARAH_DELTA
$ -> LISTEN_MARIE_SARAH_DELTA = GOTO -> AFFECTING:SET-UP*ADD_COUNTER_TWO, TALK:MARIE_SARAH_DELTA
TALKED -> MARIE_SARAH_DELTA = ACTION_ONE -> NULL
$ -> WAITFOR_STOP_MARIE_SARAH_DELTA_CONVERSATION = WAITFOR -> TIMER:15 ? STOP_MARIE_SARAH_DELTA_CONVERSATION
$ -> STOP_MARIE_SARAH_DELTA_CONVERSATION = GOTO -> TA_NULL, AFFECTING:DELTA*DELTA_TA_NULL, PLAYER_AVOIDER_TYPE:STOP, SLOW:26-43
GOAL -> 26-43 = GOTO -> GO_INVENTORY, AFFECTING:SARAH*GO_SEARCH_ALICIA_DESK_FROM_ALICIA_DESK


//// INVENTORY ////

GOAL -> 16-35 = GOTO -> TA_NULL, GO_INVENTORY
$ -> GO_INVENTORY = GOTO -> PLAYER_AVOIDER_TYPE:STOP, SLOW:15-39
WONPUZZLE -> 14-39 = MEMORY -> STOCK_ROOM_OPENED
GOAL -> 15-39 = GOTO -> PLAYER_AVOIDER_TYPE:CUTSCENE, FACING:LEFT, MEMORY:SARAH_CAN_AHEAD_ALICIA_DESK, PARSE_STOCK_ROOM_OPENED
$ -> PARSE_STOCK_ROOM_OPENED = MEMORY -> STOCK_ROOM_OPENED ? SLOW:11-39 / WAITFOR_OPENING_STOCK_ROOM
$ -> WAITFOR_HEADING_STOCK = WAITFOR -> TIMER:1 ? SLOW:11-39
$ -> WAITFOR_OPENING_STOCK_ROOM = WAITFOR -> TIMER:2 ? OPENING_STOCK_ROOM, WAITFOR_HEADING_STOCK
$ -> OPENING_STOCK_ROOM = GOTO -> SOUND_IF_CAMERA:DOOR_UNLOCK, CREATE_STOCK_ROOM_NULL_DOOR, DELETE_STOCK_ROOM_CYAN_DOOR, UNLOCK_STOCK_ROOM_DOOR_ANIMATION, MEMORY:STOCK_ROOM_OPENED
$ -> CREATE_STOCK_ROOM_NULL_DOOR = CREATE -> 14-39-FRONT:1-235-0
$ -> DELETE_STOCK_ROOM_CYAN_DOOR = DELETE -> 14-39:WORLD,1
$ -> UNLOCK_STOCK_ROOM_DOOR_ANIMATION = CREATE -> 14-39-FRONT:1-128-1

GOAL -> 11-39 = MEMORY -> TA_INVENTORY ? FACING:DOWN, WAITFOR_CONTINUE_INVENTORY / MEMORY:TA_INVENTORY, A1_INVENTORY, FACING:DOWN, WAITFOR_CONTINUE_INVENTORY
$ -> WAITFOR_CONTINUE_INVENTORY = WAITFOR -> TIMER:6 ? CONTINUE_INVENTORY_CONDITIONNAL
$ -> CONTINUE_INVENTORY_CONDITIONNAL = MEMORY -> MARIE_WONT_REACT_TO_REBECCA_PRESENCE_ANYMORE ? CONTINUE_INVENTORY / PARSE_REBECCA_IS_IN_INVENTORY_ROOM
$ -> PARSE_REBECCA_IS_IN_INVENTORY_ROOM = SEE -> PLAYER ? PARSE_MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE_NEXT / CONTINUE_INVENTORY
$ -> PARSE_MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE_NEXT = MEMORY -> MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE_NEXT ? TALK:MARIE_ROMANCE*INVENTORY_LAST / PARSE_MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE
$ -> PARSE_MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE = MEMORY -> MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE ? WAITFOR_CONTINUE_INVENTORY, TALK:MARIE_ROMANCE*INVENTORY_NEXT / PARSE_MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE_INITIATIVE
$ -> PARSE_MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE_INITIATIVE = MEMORY -> MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE_INITIATIVE ? TALK_MARIE_INVENTORY_INITIATIVE_CONDITIONNAL / MEMORY:MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE_INITIATIVE, CONTINUE_INVENTORY
$ -> TALK_MARIE_INVENTORY_INITIATIVE_CONDITIONNAL = MEMORY -> MARIE_MET ? TALK:MARIE_ROMANCE*INVENTORY_INITIATIVE / TALK:MARIE_ROMANCE*INVENTORY_INITIATIVE_HELLO
$ -> CONTINUE_INVENTORY = RANDOM -> PERCENTAGE:33 ? INVENTORY_COMPUTER / INVENTORY_BOXES
$ -> INVENTORY_BOXES = RANDOM -> PERCENTAGE:50 ? INVENTORY_BOMB / INVENTORY_BOX
$ -> INVENTORY_COMPUTER = SLOW -> 11-39
$ -> INVENTORY_BOMB = SLOW -> 12-38
$ -> INVENTORY_BOX = SLOW -> 11-38
GOAL -> 11-38 = GOTO -> FACING:UP, WAITFOR_CONTINUE_INVENTORY
GOAL -> 12-38 = GOTO -> FACING:UP, WAITFOR_CONTINUE_INVENTORY
$ -> A1_INVENTORY = ACTION_ONE -> CUSTOM(ASK_FOR_BOMBS)TALK_MARIE_INVENTORY_BOMB
$ -> TALK_MARIE_INVENTORY_BOMB = GOTO -> CUTSCENE:START, TP_ALICIA_IN_INVENTORY_CONDITIONNAL, WAITFOR_TALK_MARIE_INVENTORY_BOMB
$ -> TP_ALICIA_IN_INVENTORY_CONDITIONNAL = MEMORY -> ALICIA_FOLLOW_PLAYER ? AFFECTING:ALICIA*TP_TO_PLAYER / NULL
$ -> WAITFOR_TALK_MARIE_INVENTORY_BOMB = WAITFOR -> TIMER:1 ? TALK_MARIE_INVENTORY_BOMB_CONDITIONNAL
$ -> TALK_MARIE_INVENTORY_BOMB_CONDITIONNAL = MEMORY -> MARIE_MET ? TALK:MARIE_ROMANCE*INVENTORY_BOMB / TALK:MARIE_ROMANCE*INVENTORY_HELLO
TALKED -> MARIE_ROMANCE*INVENTORY_HELLO = GOTO -> MEMORY:MARIE_MET, TALK:MARIE_ROMANCE*INVENTORY_BOMB
TALKED -> MARIE_ROMANCE*INVENTORY_BOMB = MEMORY -> ALICIA_FOLLOW_PLAYER ? PARSE_ALICIA_IS_FINE_WITH_BOMBING_ENTRANCE / TALKED_MARIE_INVENTORY_BOMB
TALKED -> MARIE_ROMANCE*INVENTORY_INITIATIVE_HELLO = TALK -> MARIE_ROMANCE*INVENTORY_INITIATIVE
TALKED -> MARIE_ROMANCE*INVENTORY_INITIATIVE = GOTO -> MEMORY:MARIE_MET, MEMORY:MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE_NEXT, ACTION_ONE:NULL, ACTION_THREE:TALK(KEEP_WATCHING_MARIE)MARIE_ROMANCE*INVENTORY_LAST, WAITFOR_CONTINUE_INVENTORY
$ -> PARSE_ALICIA_IS_FINE_WITH_BOMBING_ENTRANCE = MEMORY -> ALICIA_IS_FINE_WITH_BOMBING_ENTRANCE ? TALKED_MARIE_INVENTORY_BOMB / TALKED_MARIE_INVENTORY_BOMB_ALICIA
$ -> TALKED_MARIE_INVENTORY_BOMB_ALICIA = MEMORY -> ALICIA_BOMB_OK_I_STOP ? WAITFOR_ALICIA_WORRIER_ABOUT_BOMBS / WAITFOR_ALICIA_WORRY_ABOUT_BOMBS
$ -> WAITFOR_ALICIA_WORRIER_ABOUT_BOMBS = WAITFOR -> TIMER:2 ? TALK:ALICIA_WORRIER_ABOUT_BOMBS
$ -> WAITFOR_ALICIA_WORRY_ABOUT_BOMBS = WAITFOR -> TIMER:2 ? TALK:ALICIA_WORRY_ABOUT_BOMBS
TALKED -> ALICIA_WORRIER_ABOUT_BOMBS = GOTO -> CUTSCENE:STOP, WAITFOR_CONTINUE_INVENTORY, ACTION_ONE:TALK(WATCH_MARIE)MARIE_ROMANCE*INVENTORY_NEXT
TALKED -> ALICIA_WORRY_ABOUT_BOMBS = GOTO -> CUTSCENE:STOP, WAITFOR_CONTINUE_INVENTORY, ACTION_ONE:TALK(WATCH_MARIE)MARIE_ROMANCE*INVENTORY_NEXT
$ -> TALKED_MARIE_INVENTORY_BOMB = WAITFOR -> TIMER:3 ? TALK:MARIE_ROMANCE*INVENTORY_BOMB_NEXT
TALKED -> MARIE_ROMANCE*INVENTORY_BOMB_NEXT = WAITFOR -> TIMER:6 ? TALK:MARIE_ROMANCE*INVENTORY_BOMB_LAST
TALKED -> MARIE_ROMANCE*INVENTORY_BOMB_LAST = GOTO -> CUTSCENE:STOP, MEMORY:MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE, WAITFOR_CONTINUE_INVENTORY, ACTION_ONE:TALK(WATCH_MARIE)MARIE_ROMANCE*INVENTORY_NEXT
TALKED -> MARIE_ROMANCE*INVENTORY_NEXT = MEMORY -> ALICIA_FOLLOW_PLAYER ? NULL / MEMORY:MARIE_CAN_ASK_REBECCA_ABOUT_PRESENCE_NEXT, ACTION_ONE:NULL, ACTION_THREE:TALK(KEEP_WATCHING_MARIE)MARIE_ROMANCE*INVENTORY_LAST
TALKED -> MARIE_ROMANCE*INVENTORY_LAST = MEMORY -> ALICIA_FOLLOW_PLAYER ? MARIE_WONT_REACT_TO_REBECCA_PRESENCE_ANYMORE / MUSIC:NULL, START_ROMANCE
$ -> START_ROMANCE = GOTO -> CREATE_ROMANCE_HELPER_HANDLER, MARIE_WONT_REACT_TO_REBECCA_PRESENCE_ANYMORE, START_FEELING_EMBARASSED
$ -> MARIE_WONT_REACT_TO_REBECCA_PRESENCE_ANYMORE = GOTO -> TA_NULL, MEMORY:MARIE_WONT_REACT_TO_REBECCA_PRESENCE_ANYMORE
$ -> START_FEELING_EMBARASSED = WAITFOR -> TIMER:10 ? TALK:MARIE_ROMANCE*EMBARASSED

$ -> CREATE_ROMANCE_HELPER_HANDLER = GOTO -> MOVE:STOP, FACING:PLAYER, CREATE_ROMANCE_HELPER, AFFECTING:OBJ-66*INIT_MARIE_ROMANCE_HELPER
$ -> CREATE_ROMANCE_HELPER = CREATE -> 10-39-FRONT:66-255-255
TALKED -> MARIE_ROMANCE*DISILLUSIONED = GOTO -> MUSIC:LABORATORY, WAITFOR_CONTINUE_INVENTORY
TALKED -> MARIE_ROMANCE*DISILLUSIONED_NEXT = GOTO -> MUSIC:LABORATORY, WAITFOR_CONTINUE_INVENTORY

TALKED -> MARIE_ROMANCE*EMBARASSED = WAITFOR -> TIMER:7 ? TALK:MARIE_ROMANCE*EMBARASSED_NEXT
TALKED -> MARIE_ROMANCE*EMBARASSED_NEXT = WAITFOR -> TIMER:7 ? TALK:MARIE_ROMANCE*EMBARASSED_NEXT_NEXT
TALKED -> MARIE_ROMANCE*EMBARASSED_NEXT_NEXT = WAITFOR -> TIMER:7 ? TALK:MARIE_ROMANCE*EMBARASSED_NEXT_NEXT_NEXT
TALKED -> MARIE_ROMANCE*EMBARASSED_NEXT_NEXT_NEXT = WAITFOR -> TIMER:7 ? TALK:MARIE_ROMANCE*EMBARASSED_NEXT_NEXT_NEXT_NEXT
TALKED -> MARIE_ROMANCE*EMBARASSED_NEXT_NEXT_NEXT_NEXT = WAITFOR -> TIMER:7 ? TALK:MARIE_ROMANCE*EMBARASSED_LAST
TALKED -> MARIE_ROMANCE*EMBARASSED_LAST = GOTO -> MUSIC:NULL, TALK:MARIE_ROMANCE*EMBARASSED_LAST_NEXT
TALKED -> MARIE_ROMANCE*EMBARASSED_LAST_NEXT = GOTO -> MUSIC:LABORATORY, CONDITION:CRY, PARSE_ROMANCE_CONDITION
$ -> PARSE_ROMANCE_CONDITION = WAITFOR -> PLAYER_FUTHER_THAN:2 ? CONDITION:GOOD, AFFECTING:PLAYER*TP_PLAYER_TO_INVENTORY, TALK:MARIE_ROMANCE*WILL_YOU
TALKED -> MARIE_ROMANCE*WILL_YOU = GOTO -> CUTSCENE:START, FACING_PLAYER:LEFT, MUSIC:L'AMOUREUSE, SLOW:PLAYER, WAITFOR_TALK_MARIE_ROMANCE_NEXT
$ -> WAITFOR_TALK_MARIE_ROMANCE_NEXT = WAITFOR -> TIMER:2 ? TALK:MARIE_ROMANCE*WILL_YOU_NEXT
TALKED -> MARIE_ROMANCE*WILL_YOU_NEXT = CHOICE -> OBJECT : (YES)DATING_MARIE_ACCEPT, (NO)DATING_MARIE_REFUSE
! -> DATING_MARIE_REFUSE = GOTO -> MUSIC:NULL, WAITFOR_TALK_MARIE_ROMANCE_NO
$ -> WAITFOR_TALK_MARIE_ROMANCE_NO = WAITFOR -> TIMER:4 ? ACHIEVEMENT:BROKENHEART, WAITFOR_TALK_MARIE_ROMANCE_NO_FUTHER
$ -> WAITFOR_TALK_MARIE_ROMANCE_NO_FUTHER = WAITFOR -> TIMER:6 ? TALK:MARIE_ROMANCE*WILL_YOU_NO
TALKED -> MARIE_ROMANCE*WILL_YOU_NO = GOTO -> PLAYER_AVOIDER_TYPE:THROUGH, SLOW:16-33
! -> DATING_MARIE_ACCEPT = TALK -> MARIE_ROMANCE*WILL_YOU_YES
TALKED -> MARIE_ROMANCE*WILL_YOU_YES = WAITFOR -> TIMER:4 ? TALK:MARIE_ROMANCE*WILL_YOU_YES_NEXT
TALKED -> MARIE_ROMANCE*WILL_YOU_YES_NEXT = GOTO -> CUTSCENE:STOP_WITH_DELAY, ADD_COUNTER_THREE, RENAME_COUNTER_THREE, AFFECTING:OBJ-66*MARIE_WANNA_HUG_REBECCA, CONTINUE_INVENTORY
$ -> ADD_COUNTER_THREE = COUNTER_THREE -> ADD, 1
$ -> RENAME_COUNTER_THREE = COUNTER_THREE -> CREATE, LESBIAN_ROMANCE
! -> MARIE_WILL_HUG_REBECCA = GOTO -> CUTSCENE:START, WAITFOR_NULL, MOVE:13-39
GOAL -> 13-39 = GOTO -> SOUND:JUMP, TP:13-65, CREATE_MARIE_HUG_REBECCA, WAITFOR_STOP_HUGGING_REBECCA
$ -> WAITFOR_STOP_HUGGING_REBECCA = WAITFOR -> TIMER:3 ? CUTSCENE:STOP, DELETE_MARIE_HUG_REBECCA, TP:13-39, CONTINUE_INVENTORY
$ -> CREATE_MARIE_HUG_REBECCA = CREATE_DECORATION -> 13-39-FRONT:WORLD,2,1,MARIE_HUG_REBECCA_00
$ -> DELETE_MARIE_HUG_REBECCA = DELETE -> 13-39:WORLD,2
GOAL -> 16-33 = GOTO -> CUTSCENE:STOP, TP:21-24, CONDITION:CRY, LOCK_TOILET_DOOR_UP


//// INQUIRY ////

! -> SCENARIO_INQUIRY = TRIPLE_ACTION -> CUSTOM(TALK)TALK_MARIE_HAVE_YOU_DATA
$ -> TALK_MARIE_HAVE_YOU_DATA = MEMORY -> MARIE_TALKED_ABOUT_THEFT ? TALK:MARIE_HAVE_YOU_DATA_VAR / TALK:MARIE_HAVE_YOU_DATA
! -> THEFT = ACTION_TWO -> CUSTOM(THEFT)TALK_MARIE_THEFT
$ -> TALK_MARIE_THEFT = GOTO -> MEMORY:MARIE_TALKED_ABOUT_THEFT, TALK:MARIE_THEFT
TALKED -> MARIE_THEFT = WAITFOR -> PLAYER_FUTHER_THAN:3 ? TALK:MARIE_THEFT_NEXT