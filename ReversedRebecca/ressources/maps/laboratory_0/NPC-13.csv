TIME -> 0 = GOTO -> NAME:ALICIA, MOVE:26-34, TURN_DOOR_INTO_SPEAKABLE


//// STATE ////

GOAL -> 26-34 = GOTO -> FACING:DOWN, PARSE_ALICIA_IS_HAPPY
$ -> PARSE_ALICIA_IS_HAPPY = MEMORY -> ALICIA_IS_HAPPY ? CONDTION:GOOD, WAITING_HAPPILY_IN_AIRLOCK_START, MEMORY:ALICIA_NO_LONGER_CRYING / CONDITION:CRY
$ -> WAITFOR_NULL = WAITFOR -> NULL
! -> ALICIA_PUSHED_TO_DEATH = GOTO -> PUSH:DOWN, DISPLAY_DOWNER
$ -> DISPLAY_DOWNER = DISPLAY -> 0, 6


//// SPEAKABLE DOOR ////

$ -> TURN_DOOR_INTO_SPEAKABLE = GOTO -> CREATE_SPEAKABLE_DOOR, AFFECTING:SPEAKABLE_DOOR_INIT
$ -> CREATE_SPEAKABLE_DOOR = CREATE -> 26-36-BACK:23-255-255
! -> ALICIA_KNOCK = GOTO -> SOUND:DOOR_KNOCK, CREATE_BONUSTEXT_KNOCK, CUTSCENE:START, WAITFOR_ALICIA_KNOW_REALISATION
$ -> CREATE_BONUSTEXT_KNOCK = CREATE_BONUSTEXT -> 26-36,NORMAL,KNOCK
$ -> WAITFOR_ALICIA_KNOW_REALISATION = WAITFOR -> TIMER:1 ? CONDITION:GOOD, EXPRESSION:EXCLAMATION, WAITFOR_MOVE_TO_DOOR
$ -> WAITFOR_MOVE_TO_DOOR = WAITFOR -> TIMER:1 ? MOVE:26-35

GOAL -> 26-35 = MEMORY -> MIKA_REACHED_AIRLOCK_TO_UNLOCK_ALICIA ? AFFECTING:ALICIA_TALKING_TO_MIKA_WHO_WILL_BREAK_DOOR, WAITFOR_MOVING_AWAY_BREAK_DONW_DOOR / PARSE_REBECCA_IS_SADISTIC_ABOUT_ALICIA
$ -> PARSE_REBECCA_IS_SADISTIC_ABOUT_ALICIA = MEMORY -> REBECCA_IS_SADISTIC_ABOUT_ALICIA ? TALK:ALICIA_LOCKED_SADISTIC / PARSE_ALICIA_KNOCK_SENARIO
$ -> PARSE_ALICIA_KNOCK_SENARIO = MEMORY -> SCENARIO_INQUIRY ? TALK:ALICIA_LOCKED_INQUIRY / TALK:ALICIA_LOCKED_EXIT
TALKED -> ALICIA_LOCKED_SADISTIC = GOTO -> CUTSCENE:STOP, SLOW:26-34
TALKED -> ALICIA_LOCKED_INQUIRY = GOTO -> CUTSCENE:STOP, MEMORY:ALICIA_IS_HAPPY, AFFECTING:ALICIA_LOCKED_IN_AIRLOCK_SEARCHING_HELP, MEMORY:ALICIA_LOCKED_IN_AIRLOCK_SEARCHING_HELP, SLOW:26-34
TALKED -> ALICIA_LOCKED_EXIT = GOTO -> CUTSCENE:STOP, MEMORY:ALICIA_IS_HAPPY, SLOW:26-34
$ -> WAITING_HAPPILY_IN_AIRLOCK_START = WAITFOR -> TIMER:5 ? RAD_FACING, WAITING_HAPPILY_IN_AIRLOCK_STEP_ONE
$ -> RAD_FACING = RANDOM -> PERCENTAGE:50 ? FACING:LEFT / FACING:UP
$ -> WAITING_HAPPILY_IN_AIRLOCK_STEP_ONE = WAITFOR -> TIMER:2 ? FACING:DOWN, WAITING_HAPPILY_IN_AIRLOCK_STEP_TWO
$ -> WAITING_HAPPILY_IN_AIRLOCK_STEP_TWO = WAITFOR -> TIMER:4 ? FACING:RIGHT, WAITING_HAPPILY_IN_AIRLOCK_STEP_THREE
$ -> WAITING_HAPPILY_IN_AIRLOCK_STEP_THREE = WAITFOR -> TIMER:2 ? SLOW:27-34, WAITING_HAPPILY_IN_AIRLOCK_STEP_FOUR
$ -> WAITING_HAPPILY_IN_AIRLOCK_STEP_FOUR = WAITFOR -> TIMER:6 ? SLOW:26-34
! -> MIKA_REACHED_AIRLOCK_TO_UNLOCK_ALICIA = GOTO -> WAITFOR_NULL, SLOW:26-35
$ -> WAITFOR_MOVING_AWAY_BREAK_DONW_DOOR = WAITFOR -> TIMER:4 ? MOVE:25-33
GOAL -> 25-33 = FACING -> DOWN


//// AIRLOCK DOWN ////

WONPUZZLE -> 26-36 = GOTO -> ALICIA_NORMAL_CUTSCENE
$ -> ALICIA_NORMAL_CUTSCENE = GOTO -> CUTSCENE:START, CAMERA:FIX, ALICIA_NORMAL_CUTSCENE_UPDATE_OBJECTS, WAITFOR_ALICIA_NORMAL_CUTSCENE
$ -> ALICIA_NORMAL_CUTSCENE_UPDATE_OBJECTS = GOTO -> DELETE_DOWN_DOOR
$ -> WAITFOR_ALICIA_NORMAL_CUTSCENE = WAITFOR -> TIMER:1 ? CONDITION:GOOD, FACING:DOWN, EXPRESSION:EXCLAMATION, WAITFOR_RUNNING_TO_HUG_REBECCA_DOWN
$ -> WAITFOR_RUNNING_TO_HUG_REBECCA_DOWN = WAITFOR -> TIMER:1 ? FAST:26-36
GOAL -> 26-36 = GOTO -> SOUND:HIT_SMALL, CREATE_HUG_ANIMATION_DOWN, AFFECTING:TP_PLAYER_OUT_OF_SIGHT, TP:25-70, WAITFOR_TALK_HUG_DOWN
$ -> CREATE_HUG_ANIMATION_DOWN = CREATE_ANIMATION -> 26-36-BACK:WORLD,1,4,ALICIA_HUG_DOWN_REBECCA,5,2,FALSE
$ -> CREATE_DOWN_DOOR = CREATE -> 26-36-FRONT:1-235-0
$ -> DELETE_DOWN_DOOR = DELETE -> 26-36:WORLD,1
$ -> WAITFOR_TALK_HUG_DOWN = WAITFOR -> TIMER:3 ? MEMORY:ALICIA_HUG_DOWN, TALK:ALICIA_HUG
TALKED -> ALICIA_HUG = MEMORY -> ALICIA_HUG_DOWN ? TALKED_ALICIA_HUG_DOWN / TALKED_ALICIA_HUG
$ -> TALKED_ALICIA_HUG_DOWN = GOTO -> FACING:DOWN, TP:26-38, AFFECTING:TP_PLAYER_NEAR_ALICIA_DOWN, DELETE_DOWN_DOOR, SOUND:JUMP, WAITFOR_TALK_PICK_ME_UP
$ -> WAITFOR_TALK_PICK_ME_UP = WAITFOR -> TIMER:2 ? TALK:ALICIA_PICK_ME_UP
TALKED -> ALICIA_PICK_ME_UP = CHOICE -> COFFEE*ALICIA_ASK_DRINK, TEA*ALICIA_ASK_DRINK, NO_THANKS*ALICIA_NO_THANKS
! -> ALICIA_ASK_DRINK = GOTO -> MEMORY:ALICIA_ASKED_DRINK, TALK:ALICIA_ASK_DRINK
! -> ALICIA_NO_THANKS = TALK -> ALICIA_NO_THANKS
TALKED -> ALICIA_ASK_DRINK = GOTO -> PLAYER_AVOIDER_TYPE:STOP, SLOW:7-29, CREATE_DOWN_DOOR, STOP_ALICIA_CUTSCENE
TALKED -> ALICIA_NO_THANKS = GOTO -> PLAYER_AVOIDER_TYPE:STOP, SLOW:7-29, CREATE_DOWN_DOOR, STOP_ALICIA_CUTSCENE
$ -> STOP_ALICIA_CUTSCENE = GOTO -> CUTSCENE:STOP, CAMERA:PLAYER_FLUID


//// AIRLOCK RIGHT ////

WONPUZZLE -> 28-34 = GOTO -> ALICIA_LANDSLIDE_CUTSCENE
$ -> ALICIA_LANDSLIDE_CUTSCENE = GOTO -> CUTSCENE:START, CAMERA:FIX, ALICIA_LANDSLIDE_CUTSCENE_UPDATE_OBJECTS, WAITFOR_ALICIA_LANDSLIDE_CUTSCENE
$ -> ALICIA_LANDSLIDE_CUTSCENE_UPDATE_OBJECTS = GOTO -> AFFECTING:ALICIA_LANDSLIDE_WAITFOR_NULL, AFFECTING:ALICIA_RUBBLE_CHECKERS_DELETE, AFFECTING:DELETE_SPEAKABLE_DOOR, DELETE_DOOR
$ -> WAITFOR_ALICIA_LANDSLIDE_CUTSCENE = WAITFOR -> TIMER:1 ? CONDITION:GOOD, FACING:RIGHT, EXPRESSION:EXCLAMATION, WAITFOR_RUNNING_TO_HUG_REBECCA
$ -> WAITFOR_RUNNING_TO_HUG_REBECCA = WAITFOR -> TIMER:1 ? FAST:28-34
GOAL -> 28-34 = GOTO -> SOUND:HIT_SMALL, CREATE_HUG_ANIMATION, AFFECTING:TP_PLAYER_OUT_OF_SIGHT, TP:25-70, WAITFOR_TALK_HUG
$ -> CREATE_HUG_ANIMATION = CREATE_ANIMATION -> 28-34-BACK:WORLD,3,1,ALICIA_HUG_REBECCA,41,2,FALSE
$ -> CREATE_DOOR = CREATE -> 28-34-FRONT:1-235-0
$ -> DELETE_DOOR = DELETE -> 28-34:WORLD,1
$ -> WAITFOR_TALK_HUG = WAITFOR -> TIMER:5 ? TALK:ALICIA_HUG
$ -> TALKED_ALICIA_HUG = GOTO -> FACING:RIGHT, TP:29-34, AFFECTING:TP_PLAYER_NEAR_ALICIA, DELETE_DOOR, SOUND:JUMP, WAITFOR_PARSE_ALICIA_LANDSLIDE
$ -> WAITFOR_PARSE_ALICIA_LANDSLIDE = WAITFOR -> TIMER:1 ? PARSE_ALICIA_LANDSLIDE
$ -> PARSE_ALICIA_LANDSLIDE = MEMORY -> ALICIA_PLAYERLESS_START_LANDSLIDE ? WAITFOR_TALK_ALICIA_LANDSLIDE_THERE / DESK_LANDSLIDING
$ -> WAITFOR_TALK_ALICIA_LANDSLIDE_THERE = WAITFOR -> TIMER:1 ? TALK:ALICIA_LANDSLIDE_THERE
TALKED -> ALICIA_LANDSLIDE_THERE = GOTO -> CREATE_DOOR, STOP_ALICIA_CUTSCENE, START_FOLLOWING_PLAYER, PARSE_LANDSLIDE_EVIL_IDEA
$ -> DESK_LANDSLIDING = GOTO -> AFFECTING:ALICIA_LANDSLIDE_START, AFFECTING:PLAYER_NOTICE_ALICIA_LANDSLIDE, NOTICE_ALICIA_LANDSLIDE
$ -> NOTICE_ALICIA_LANDSLIDE = GOTO -> FACING:DOWN, EXPRESSION:EXCLAMATION, WAITFOR_MOVE_BEFORE_LANDSLIDE
$ -> WAITFOR_MOVE_BEFORE_LANDSLIDE = WAITFOR -> TIMER:1 ? WAITFOR_CREATE_DOOR, MOVE:30-34
$ -> WAITFOR_CREATE_DOOR = WAITFOR -> FACING:RIGHT ? CREATE_DOOR
GOAL -> 30-34 = FACING -> DOWN
TALKED -> ALICIA_LANDSLIDE_DESK = WAITFOR -> TIMER:3 ? TALK:ALICIA_LANDSLIDE_DESK_NEXT
TALKED -> ALICIA_LANDSLIDE_DESK_NEXT = GOTO -> STOP_ALICIA_CUTSCENE, START_FOLLOWING_PLAYER, PARSE_LANDSLIDE_EVIL_IDEA
$ -> PARSE_LANDSLIDE_EVIL_IDEA = MEMORY -> PSYCOPATH ? TALK:LANDSLIDE_EVIL_IDEA / NULL
$ -> START_FOLLOWING_PLAYER = GOTO -> PLAYER_AVOIDER_TYPE:THROUGH, WAITFOR_STUN:FALSE, FOLLOW_PLAYER
$ -> FOLLOW_PLAYER = WAITFOR -> TIMER:1 ? PARSE_FOLLOW_PLAYER_FAR, PARSE_FOLLOW_PLAYER_CLOSE, FOLLOW_PLAYER
$ -> PARSE_FOLLOW_PLAYER_FAR = PLAYER_FUTHER_THAN -> 2 ? MOVE:PLAYER / NULL
$ -> PARSE_FOLLOW_PLAYER_CLOSE = PLAYER_CLOSER_THAN -> 3 ? FACING:PLAYER / NULL


//// BOMB PATH ////

WONPUZZLE -> 56-32 = SEE -> PLAYER ? PARSE_PSYCOPATH_BOMBING_OWN_DESK / AFFECTING:BOMBING_OWN_DESK_NO_ALICIA
$ -> PARSE_PSYCOPATH_BOMBING_OWN_DESK = MEMORY -> PSYCOPATH ? TALK:ALICIA_BOMBING_OWN_DESK_EVIL / TALK:ALICIA_BOMBING_OWN_DESK
TALKED -> ALICIA_BOMBING_OWN_DESK = FACING_PLAYER -> UP
TALKED -> ALICIA_BOMBING_OWN_DESK_EVIL = FACING_PLAYER -> UP
WONPUZZLE -> 57-27 = PLAYER_CLOSER_THAN -> 30 ? PARSE_PSYCOPATH_BOMBING_OWN_DESK_AGAIN / NULL
$ -> PARSE_PSYCOPATH_BOMBING_OWN_DESK_AGAIN = MEMORY -> PSYCOPATH ? MEMORY:REBECCA_PROMISED_NO_MORE_BOMBS, TALK:ALICIA_BOMBING_OWN_DESK_AGAIN_EVIL / PARSE_PLAYER_GREEN_KEY
$ -> PARSE_PLAYER_GREEN_KEY = UNLOCKEDTOOL -> KEY:GREEN ? MEMORY:REBECCA_PROMISED_NO_MORE_BOMBS, TALK:ALICIA_BOMBING_OWN_DESK_AGAIN_VAR / TALK:ALICIA_BOMBING_OWN_DESK_AGAIN
TALKED -> ALICIA_BOMBING_OWN_DESK_AGAIN = FACING_PLAYER -> UP
TALKED -> ALICIA_BOMBING_OWN_DESK_AGAIN_EVIL = FACING_PLAYER -> UP
WONPUZZLE -> 56-22 = PLAYER_CLOSER_THAN -> 35 ? WAITFOR_NULL, MOVE:STOP, TP:56-24, FACING:UP, MEMORY:ERIC_RUN_WHILE_ALICIA_HERE / NULL
TALKED -> ERIC_FREAKS_OUT_ALICIA_HERE = MOVE -> 59-19
GOAL -> 59-19 = GOTO -> FACING:RIGHT, WAITFOR_PARSE_REBECCA_PROMISED_NO_MORE_BOMBS
$ -> WAITFOR_PARSE_REBECCA_PROMISED_NO_MORE_BOMBS = WAITFOR -> TIMER:3 ? PARSE_REBECCA_PROMISED_NO_MORE_BOMBS
$ -> PARSE_REBECCA_PROMISED_NO_MORE_BOMBS = MEMORY -> REBECCA_PROMISED_NO_MORE_BOMBS ? TALK:ALICIA_PISSED_OFF / TALK:ALICIA_STOP_BOMB
TALKED -> ALICIA_PISSED_OFF = MEMORY -> PSYCOPATH ? TALK:ALICIA_PISSED_OFF_EVIL / CHOICE_CONTINUE_OR_STOP_BOMBS
$ -> CHOICE_CONTINUE_OR_STOP_BOMBS = CHOICE -> NO_I_CONTINUE*BOMB_NO_I_CONTINUE, OK_I_STOP*BOMB_OK_I_STOP
TALKED -> ALICIA_PISSED_OFF_EVIL = GOTO -> PLAYER_AVOIDER_TYPE:CUTSCENE, MOVE:56-21
GOAL -> 56-21 = TALK -> ALICIA_PISSED_OFF_NEXT
TALKED -> ALICIA_STOP_BOMB = CHOICE -> NO_I_CONTINUE*BOMB_NO_I_CONTINUE, OK_I_STOP*BOMB_OK_I_STOP
! -> BOMB_NO_I_CONTINUE = UNLOCKEDTOOLMAXLEVEL -> KEY:GREEN ? TALK:ALICIA_BOMB_NO_I_CONTINUE / TALK:ALICIA_BOMB_NO_I_CONTINUE_NO_KEY
TALKED -> ALICIA_BOMB_NO_I_CONTINUE = GOTO -> PLAYER_AVOIDER_TYPE:CUTSCENE, SLOW:56-20
TALKED -> ALICIA_BOMB_NO_I_CONTINUE_NO_KEY = GOTO -> PLAYER_AVOIDER_TYPE:CUTSCENE, SLOW:56-20
GOAL -> 56-20 = GOTO -> FACING_PLAYER:DOWN, SLOW:57-28
GOAL -> 57-28 = GOTO -> SLOW:42-34, PARSE_BOMBING_CONTINUE_GREEN_KEY
$ -> PARSE_BOMBING_CONTINUE_GREEN_KEY = UNLOCKEDTOOLMAXLEVEL -> KEY:GREEN ? TALK:REBECCA_NOT_THAT_BAD / TALK:REBECCA_I_HAD_NO_CHOICE
! -> BOMB_OK_I_STOP = GOTO -> DESACTIVE_LANDSLIDE, PARSE_STOP_BOMB_AND_HAS_GREEN_KEY
$ -> DESACTIVE_LANDSLIDE = DISABLE -> 58-17:1
$ -> PARSE_STOP_BOMB_AND_HAS_GREEN_KEY = UNLOCKEDTOOL -> KEY:GREEN ? TALK:ALICIA_I_STOP_BOMB_HAVING_KEY / PARSE_STOP_BOMB_AND_CAN_TAKE_GREEN_KEY
$ -> PARSE_STOP_BOMB_AND_CAN_TAKE_GREEN_KEY = UNLOCKEDTOOLMAXLEVEL -> KEY:GREEN ? TALK:ALICIA_I_STOP_BOMB_CAN_TAKE_KEY / TALK:ALICIA_I_STOP_BOMB_CANNOT_TAKE_KEY
TALKED -> ALICIA_I_STOP_BOMB_HAVING_KEY = GOTO -> FOLLOW_PLAYER, CUTSCENE:STOP
TALKED -> ALICIA_I_STOP_BOMB_CAN_TAKE_KEY = GOTO -> MOVE:59-20, CUTSCENE:STOP_WITH_DELAY
TALKED -> ALICIA_I_STOP_BOMB_CANNOT_TAKE_KEY = GOTO -> PICKUP_KEY, FOLLOW_PLAYER, CUTSCENE:STOP_WITH_DELAY
GOAL -> 59-20 = GOTO -> FACING:LEFT, FOLLOW_PLAYER
$ -> PICKUP_KEY = PICKUP -> 59-19:1