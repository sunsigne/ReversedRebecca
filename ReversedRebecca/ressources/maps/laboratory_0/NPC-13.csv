TIME -> 0 = GOTO -> NAME:ALICIA, MOVE:26-34, TURN_DOOR_INTO_SPEAKABLE


//// STATE ////

GOAL -> 26-34 = GOTO -> FACING:DOWN, PARSE_ALICIA_IS_HAPPY
$ -> PARSE_ALICIA_IS_HAPPY = MEMORY -> ALICIA_IS_HAPPY ? CONDTION:GOOD, WAITING_HAPPILY_IN_AIRLOCK_START, MEMORY:ALICIA_NO_LONGER_CRYING / CONDITION:CRY
$ -> WAITFOR_NULL = WAITFOR -> NULL


//// SPEAKABLE DOOR ////

$ -> TURN_DOOR_INTO_SPEAKABLE = GOTO -> CREATE_SPEAKABLE_DOOR, AFFECTING:SPEAKABLE_DOOR_INIT
$ -> CREATE_SPEAKABLE_DOOR = CREATE -> 26-36-BACK:23-255-255
! -> ALICIA_KNOCK = GOTO -> SOUND:DOOR_KNOCK, CREATE_BONUSTEXT_KNOCK, CUTSCENE:START, WAITFOR_ALICIA_KNOW_REALISATION
$ -> CREATE_BONUSTEXT_KNOCK = CREATE_BONUSTEXT -> 26-36,NORMAL,KNOCK
$ -> WAITFOR_ALICIA_KNOW_REALISATION = WAITFOR -> TIMER:1 ? CONDITION:GOOD, EXPRESSION:EXCLAMATION, WAITFOR_MOVE_TO_DOOR
$ -> WAITFOR_MOVE_TO_DOOR = WAITFOR -> TIMER:1 ? MOVE:26-35

GOAL -> 26-35 = MEMORY -> MIKA_REACHED_AIRLOCK_TO_UNLOCK_ALICIA ? AFFECTING:ALICIA_TALKING_TO_MIKA_WHO_WILL_BREAK_DOOR, WAITFOR_MOVING_AWAY_BREAK_DONW_DOOR / PARSE_REBECCA_IS_SADISTIC_ABOUT_ALICIA
$ -> PARSE_REBECCA_IS_SADISTIC_ABOUT_ALICIA = MEMORY -> REBECCA_IS_SADISTIC_ABOUT_ALICIA ? TALK:ALICIA_LOCKED_SADISTIC / PARSE_ALICIA_KNOCK_SENARIO
$ -> PARSE_ALICIA_KNOCK_SENARIO = MEMORY -> SCENARIO_INQUIRY ? TALK:ALICIA_LOCKED_INQUIRY / TALK:ALICIA_LOCKED_EXIT
TALKED -> ALICIA_LOCKED_SADISTIC = GOTO -> CUTSCENE:STOP, SLOW:26-34
TALKED -> ALICIA_LOCKED_INQUIRY = GOTO -> CUTSCENE:STOP, MEMORY:ALICIA_IS_HAPPY, AFFECTING:ALICIA_LOCKED_IN_AIRLOCK_SEARCHING_HELP, MEMORY:ALICIA_LOCKED_IN_AIRLOCK_SEARCHING_HELP, SLOW:26-34
TALKED -> ALICIA_LOCKED_EXIT = GOTO -> CUTSCENE:STOP, MEMORY:ALICIA_IS_HAPPY, SLOW:26-34
$ -> WAITING_HAPPILY_IN_AIRLOCK_START = WAITFOR -> TIMER:5 ? RAD_FACING, WAITING_HAPPILY_IN_AIRLOCK_STEP_ONE
$ -> RAD_FACING = RANDOM -> PERCENTAGE:50 ? FACING:LEFT / FACING:UP
$ -> WAITING_HAPPILY_IN_AIRLOCK_STEP_ONE = WAITFOR -> TIMER:2 ? FACING:DOWN, WAITING_HAPPILY_IN_AIRLOCK_STEP_TWO
$ -> WAITING_HAPPILY_IN_AIRLOCK_STEP_TWO = WAITFOR -> TIMER:4 ? FACING:RIGHT, WAITING_HAPPILY_IN_AIRLOCK_STEP_THREE
$ -> WAITING_HAPPILY_IN_AIRLOCK_STEP_THREE = WAITFOR -> TIMER:2 ? SLOW:27-34, WAITING_HAPPILY_IN_AIRLOCK_STEP_FOUR
$ -> WAITING_HAPPILY_IN_AIRLOCK_STEP_FOUR = WAITFOR -> TIMER:6 ? SLOW:26-34
! -> MIKA_REACHED_AIRLOCK_TO_UNLOCK_ALICIA = GOTO -> WAITFOR_NULL, SLOW:26-35
$ -> WAITFOR_MOVING_AWAY_BREAK_DONW_DOOR = WAITFOR -> TIMER:4 ? MOVE:25-33
GOAL -> 25-33 = FACING -> DOWN


//// AIRLOCK DOWN ////

WONPUZZLE -> 26-36 = GOTO -> ALICIA_NORMAL_CUTSCENE
$ -> ALICIA_NORMAL_CUTSCENE = GOTO -> CUTSCENE:START, CAMERA:FIX, ALICIA_NORMAL_CUTSCENE_UPDATE_OBJECTS, WAITFOR_ALICIA_NORMAL_CUTSCENE
$ -> ALICIA_NORMAL_CUTSCENE_UPDATE_OBJECTS = GOTO -> DELETE_DOWN_DOOR
$ -> WAITFOR_ALICIA_NORMAL_CUTSCENE = WAITFOR -> TIMER:1 ? CONDITION:GOOD, FACING:DOWN, EXPRESSION:EXCLAMATION, WAITFOR_RUNNING_TO_HUG_REBECCA_DOWN
$ -> WAITFOR_RUNNING_TO_HUG_REBECCA_DOWN = WAITFOR -> TIMER:1 ? FAST:26-36
GOAL -> 26-36 = GOTO -> SOUND:HIT_SMALL, CREATE_HUG_ANIMATION_DOWN, AFFECTING:TP_PLAYER_OUT_OF_SIGHT, TP:25-70, WAITFOR_TALK_HUG_DOWN
$ -> CREATE_HUG_ANIMATION_DOWN = CREATE_ANIMATION -> 26-36-BACK:1,4,ALICIA_HUG_DOWN_REBECCA,5,2,FALSE
$ -> CREATE_DOWN_DOOR = CREATE -> 26-36-FRONT:1-235-0
$ -> DELETE_DOWN_DOOR = DELETE -> 26-36:1
$ -> WAITFOR_TALK_HUG_DOWN = WAITFOR -> TIMER:3 ? MEMORY:ALICIA_HUG_DOWN, TALK:ALICIA_HUG
TALKED -> ALICIA_HUG = MEMORY -> ALICIA_HUG_DOWN ? TALKED_ALICIA_HUG_DOWN / TALKED_ALICIA_HUG
$ -> TALKED_ALICIA_HUG_DOWN = GOTO -> FACING:DOWN, TP:26-38, AFFECTING:TP_PLAYER_NEAR_ALICIA_DOWN, DELETE_DOWN_DOOR, SOUND:JUMP, WAITFOR_TALK_PICK_ME_UP
$ -> WAITFOR_TALK_PICK_ME_UP = WAITFOR -> TIMER:2 ? TALK:ALICIA_PICK_ME_UP
TALKED -> ALICIA_PICK_ME_UP = CHOICE -> COFFEE*ALICIA_ASK_DRINK, TEA*ALICIA_ASK_DRINK, NO_THANKS*ALICIA_NO_THANKS
! -> ALICIA_ASK_DRINK = GOTO -> MEMORY:ALICIA_ASKED_DRINK, TALK:ALICIA_ASK_DRINK
! -> ALICIA_NO_THANKS = TALK -> ALICIA_NO_THANKS
TALKED -> ALICIA_ASK_DRINK = GOTO -> PLAYER_AVOIDER_TYPE:STOP, SLOW:7-29, CREATE_DOWN_DOOR, STOP_ALICIA_CUTSCENE
TALKED -> ALICIA_NO_THANKS = GOTO -> PLAYER_AVOIDER_TYPE:STOP, SLOW:7-29, CREATE_DOWN_DOOR, STOP_ALICIA_CUTSCENE
$ -> STOP_ALICIA_CUTSCENE = GOTO -> CUTSCENE:STOP, CAMERA:PLAYER_FLUID


//// AIRLOCK RIGHT ////

WONPUZZLE -> 28-34 = GOTO -> ALICIA_LANDSLIDE_CUTSCENE
$ -> ALICIA_LANDSLIDE_CUTSCENE = GOTO -> CUTSCENE:START, CAMERA:FIX, ALICIA_LANDSLIDE_CUTSCENE_UPDATE_OBJECTS, WAITFOR_ALICIA_LANDSLIDE_CUTSCENE
$ -> ALICIA_LANDSLIDE_CUTSCENE_UPDATE_OBJECTS = GOTO -> AFFECTING:ALICIA_LANDSLIDE_WAITFOR_NULL, AFFECTING:ALICIA_RUBBLE_CHECKERS_DELETE, AFFECTING:DELETE_SPEAKABLE_DOOR, DELETE_DOOR
$ -> WAITFOR_ALICIA_LANDSLIDE_CUTSCENE = WAITFOR -> TIMER:1 ? CONDITION:GOOD, FACING:RIGHT, EXPRESSION:EXCLAMATION, WAITFOR_RUNNING_TO_HUG_REBECCA
$ -> WAITFOR_RUNNING_TO_HUG_REBECCA = WAITFOR -> TIMER:1 ? FAST:28-34
GOAL -> 28-34 = GOTO -> SOUND:HIT_SMALL, CREATE_HUG_ANIMATION, AFFECTING:TP_PLAYER_OUT_OF_SIGHT, TP:25-70, WAITFOR_TALK_HUG
$ -> CREATE_HUG_ANIMATION = CREATE_ANIMATION -> 28-34-BACK:3,1,ALICIA_HUG_REBECCA,41,2,FALSE
$ -> CREATE_DOOR = CREATE -> 28-34-FRONT:1-235-0
$ -> DELETE_DOOR = DELETE -> 28-34:1
$ -> WAITFOR_TALK_HUG = WAITFOR -> TIMER:5 ? TALK:ALICIA_HUG
$ -> TALKED_ALICIA_HUG = GOTO -> FACING:RIGHT, TP:29-34, AFFECTING:TP_PLAYER_NEAR_ALICIA, DELETE_DOOR, SOUND:JUMP, WAITFOR_PARSE_ALICIA_LANDSLIDE
$ -> WAITFOR_PARSE_ALICIA_LANDSLIDE = WAITFOR -> TIMER:1 ? PARSE_ALICIA_LANDSLIDE
$ -> PARSE_ALICIA_LANDSLIDE = MEMORY -> ALICIA_PLAYERLESS_START_LANDSLIDE ? WAITFOR_TALK_ALICIA_LANDSLIDE_THERE / DESK_LANDSLIDING
$ -> WAITFOR_TALK_ALICIA_LANDSLIDE_THERE = WAITFOR -> TIMER:1 ? TALK:ALICIA_LANDSLIDE_THERE
TALKED -> ALICIA_LANDSLIDE_THERE = GOTO -> CREATE_DOOR, STOP_ALICIA_CUTSCENE, START_FOLLOWING_PLAYER
$ -> DESK_LANDSLIDING = GOTO -> AFFECTING:ALICIA_LANDSLIDE_START, AFFECTING:PLAYER_NOTICE_ALICIA_LANDSLIDE, NOTICE_ALICIA_LANDSLIDE
$ -> NOTICE_ALICIA_LANDSLIDE = GOTO -> FACING:DOWN, EXPRESSION:EXCLAMATION, WAITFOR_MOVE_BEFORE_LANDSLIDE
$ -> WAITFOR_MOVE_BEFORE_LANDSLIDE = WAITFOR -> TIMER:1 ? WAITFOR_CREATE_DOOR, MOVE:30-34
$ -> WAITFOR_CREATE_DOOR = WAITFOR -> FACING:RIGHT ? CREATE_DOOR
GOAL -> 30-34 = FACING -> DOWN
TALKED -> ALICIA_LANDSLIDE_DESK = WAITFOR -> TIMER:3 ? TALK:ALICIA_LANDSLIDE_DESK_NEXT
TALKED -> ALICIA_LANDSLIDE_DESK_NEXT = GOTO -> STOP_ALICIA_CUTSCENE, START_FOLLOWING_PLAYER
$ -> START_FOLLOWING_PLAYER = GOTO -> PLAYER_AVOIDER_TYPE:THROUGH, WAITFOR_STUN:FALSE, FOLLOW_PLAYER
$ -> FOLLOW_PLAYER = WAITFOR -> TIMER:1 ? PARSE_FOLLOW_PLAYER_FAR, PARSE_FOLLOW_PLAYER_CLOSE, FOLLOW_PLAYER
$ -> PARSE_FOLLOW_PLAYER_FAR = PLAYER_FUTHER_THAN -> 2 ? MOVE:PLAYER / NULL
$ -> PARSE_FOLLOW_PLAYER_CLOSE = PLAYER_CLOSER_THAN -> 3 ? FACING:PLAYER / NULL