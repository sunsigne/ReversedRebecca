TIME -> 0 = GOTO -> TA_INIT


//// STATE ////

SAVED -> REBECCA*USED_BATHROOM = MEMORY -> REBECCA_USED_BATHROOM
$ -> TA_INIT = TRIPLE_ACTION -> CUSTOM(USE)USE_TOILET
! -> TA_NULL = TRIPLE_ACTION -> NULL


//// USE TOILET////

$ -> USE_TOILET = GOTO -> AFFECTING:OBJ-69*TA_NULL, PARSE_STATE
$ -> PARSE_STATE = MEMORY -> PLAYER_PISSED_ON ? TALK:JEAN_PUSHED_SOMEONE*TOILET_PISSED_ON / PARSE_ALREADY_PISSED
$ -> PARSE_ALREADY_PISSED = MEMORY -> REBECCA_USED_BATHROOM ? TALK:OBJECT*TOILET / USE_TOILET_CUTSCENE
$ -> USE_TOILET_CUTSCENE = GOTO -> CUTSCENE:START, AFFECTING:ALICIA*PLAYER_USING_BATHROOM, WAITFOR_PLAYER_FACING_LEFT
$ -> WAITFOR_PLAYER_FACING_LEFT = WAITFOR -> TIMER:1 ? FACING_PLAYER:LEFT, WAITFOR_PLAYER_LOCKING_DOOR
$ -> WAITFOR_PLAYER_LOCKING_DOOR = WAITFOR -> TIMER:1 ? LOCK_DOOR_HANDLER, WAITFOR_PLAYER_SIT_ON_TOILET
$ -> LOCK_DOOR_HANDLER = GOTO -> CREATE_LOCKED_DOOR, LOCK_DOOR_ANIMATION, SOUND:DOOR_UNLOCK
$ -> LOCK_DOOR_ANIMATION = CREATE -> 20-24-FRONT:1-128-2
$ -> CREATE_LOCKED_DOOR = CREATE -> 20-24-FRONT:1-235-6
$ -> UNLOCK_DOOR_HANDLER = GOTO -> DELETE_LOCKED_DOOR, UNLOCK_DOOR_ANIMATION, SOUND:DOOR_UNLOCK
$ -> UNLOCK_DOOR_ANIMATION = CREATE -> 20-24-FRONT:1-128-1
$ -> DELETE_LOCKED_DOOR = DELETE -> 20-24:WORLD,3

$ -> WAITFOR_PLAYER_SIT_ON_TOILET = WAITFOR -> TIMER:1 ? AFFECTING:PLAYER*PLAYER_SIT_ON_TOILET, WAITING_BEFORE_DOING_STUFF
$ -> WAITING_BEFORE_DOING_STUFF = WAITFOR -> TIMER:2 ? SOUND:TOILET_DOING, WAITING_BEFORE_FINISHED
$ -> WAITING_BEFORE_FINISHED = WAITFOR -> TIMER:3 ? AFFECTING:PLAYER*PLAYER_EXIT_TOILET, WAITING_BEFORE_UNLOCKING_TOILET
$ -> WAITING_BEFORE_UNLOCKING_TOILET = WAITFOR -> TIMER:1 ? UNLOCK_DOOR_HANDLER, WAITING_BEFORE_GOING_TO_SINK
$ -> WAITING_BEFORE_GOING_TO_SINK = WAITFOR -> TIMER:1 ? AFFECTING:PLAYER*PLAYER_HEADING_SINK