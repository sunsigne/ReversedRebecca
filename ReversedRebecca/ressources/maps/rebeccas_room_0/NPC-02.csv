TIME -> 0 = GOTO -> NAME:SARAH


//// STATE ////

TIME -> 100 = MEMORY -> VISITED ? NULL / TRY_ARRIVING


//// TRY ARRIVING ////

$ -> TRY_ARRIVING = CUTSCENE -> RUNNING ? WAITING_BEFORE_ARRIVING / SECOND_VERIFICATION_ARRIVING
$ -> WAITING_BEFORE_ARRIVING = WAITFOR -> TIMER:1 ? TRY_ARRIVING
$ -> SECOND_VERIFICATION_ARRIVING = CONDITION_PLAYER -> GOOD ? AFFECTING:SARAH_ARRIVAL / THIRD_VERIFICATION_ARRIVING
$ -> THIRD_VERIFICATION_ARRIVING = CONDITION_PLAYER -> GLASS ? AFFECTING:SARAH_ARRIVAL / WAITING_BEFORE_ARRIVING


//// DOOR KNOCKING ////

! -> SARAH_ARRIVAL = GOTO -> CUTSCENE:START, SOUND:DOOR_KNOCK, WAITING_BEFORE_REALISATION, AFFECTING:SOMEONE_JUST_KNOCKED, MEMORY:VISITED
$ -> WAITING_BEFORE_REALISATION = WAITFOR -> TIMER:2 ? PLAYER_REALIZE
$ -> PLAYER_REALIZE = GOTO -> FACING_PLAYER:DOWN, EXPRESSION_PLAYER:EXCLAMATION, CUTSCENE:STOP_WITH_DELAY, WAITING_BEFORE_KNOCKING_AGAIN
$ -> WAITING_BEFORE_KNOCKING_AGAIN = WAITFOR -> TIMER:4 ? SOUND:DOOR_KNOCK, WAITING_BEFORE_KNOCKING_LAST_TIME
$ -> WAITING_BEFORE_KNOCKING_LAST_TIME = WAITFOR -> TIMER:6 ? SOUND:DOOR_KNOCK, WAITING_BEFORE_TOO_LATE
$ -> WAITING_BEFORE_TOO_LATE = WAITFOR -> TIMER:7 ? AFFECTING:TOO_LATE_AT_DOOR, MEMORY:BUT_NOBODY_CAME


//// NOBODY CAME ////

$ -> WAITING_BEFORE_NOBODY_REALISATION = WAITFOR -> TIMER:2 ? EXPRESSION_PLAYER:SUSPENSION, WAITING_BEFORE_ABANDONMENT
$ -> WAITING_BEFORE_ABANDONMENT = WAITFOR -> TIMER:2 ? TALK:DOOR_TOO_LATE_OPEN
TALKED -> DOOR_TOO_LATE_OPEN = GOTO -> AFFECTING:BLOCKING_PATH_ENTRANCE_TRUE, CUTSCENE:STOP


//// ENTERING ////

! -> SARAH_STOP_KNOCKING = WAITFOR -> TIMER:30 ? MEMORY:SORRY_FOR_THE_WAIT
! -> SARAH_ENTER = MEMORY -> BUT_NOBODY_CAME ? WAITING_BEFORE_NOBODY_REALISATION / SLOW:6-2
GOAL -> 6-2 = GOTO -> AFFECTING:BLOCKING_PATH_ENTRANCE_TRUE, CHOOSE_GREETING
$ -> CHOOSE_GREETING = CHOICE -> GREET*GREET_SARAH, HUG*HUG_SARAH
! -> GREET_SARAH = GOTO -> CUTSCENE:STOP

//// HUG SARAH ////

! -> HUG_SARAH = GOTO -> AFFECTING:HIDE_PLAYER, HIDE_SARAH, CREATE_HUG, SOUND:JUMP, WAITING_BEFORE_HUG_TALKING
$ -> WAITING_BEFORE_HUG_TALKING = WAITFOR -> TIMER:1 ? TALK:SARAH_HUG
TALKED -> REBECCA_SARAH_HUG = GOTO -> DELETE_HUG, AFFECTING:UNHIDE_PLAYER, UNHIDE_SARAH, CUTSCENE:STOP_WITH_DELAY
$ -> HIDE_SARAH = TP -> 2-15
$ -> UNHIDE_SARAH = TP -> 6-2
$ -> CREATE_HUG = CREATE_DECORATION -> 6-2-BACK:1,2,REBECCA_SARAH_HUG
$ -> DELETE_HUG = DELETE -> 6-2:1
