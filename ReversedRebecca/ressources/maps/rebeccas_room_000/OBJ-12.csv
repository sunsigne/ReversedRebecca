TIME -> 0 = GOTO -> TA_INIT, CREATE_TOILET


//// STATE ////

$ -> TA_INIT = TRIPLE_ACTION -> USE*TAKE_PEE
$ -> CREATE_TOILET = CREATE_DECORATION -> ONTHESPOT-FRONT:WORLD,1,1,TOILET_UP


//// TAKE SHIT ////

$ -> TAKE_PEE = GOTO -> CUTSCENE:START, PLAYER_DROP_GLASS, BLOCKING_PATH:FALSE, PLAYER_GOING_ON_SEAT, WAITING_BEFORE_DOING_STUFF
$ -> PLAYER_GOING_ON_SEAT = STATE_PLAYER -> 18-10,0,-4,UP,SIT, SOUND:JUMP
$ -> WAITING_BEFORE_DOING_STUFF = WAITFOR -> TIMER:1 ? SOUND:TOILET_DOING, WAITING_BEFORE_FINISHED
$ -> WAITING_BEFORE_FINISHED = WAITFOR -> TIMER:3 ? PLAYER_EXIT_SEAT, AFFECTING:PLAYER*MOVE_PLAYER_TO_SINK
$ -> PLAYER_EXIT_SEAT = STATE_PLAYER -> 18-9,0,0,UP,GOOD, BLOCKING_PATH:TRUE, SOUND:TOILET_FLUSH


//// DROP GLASS ////

$ -> PLAYER_DROP_GLASS = CONDITION_PLAYER -> GLASS ? CREATE_GLASS_HANDLER / NULL
$ -> CREATE_GLASS_HANDLER = GOTO -> CREATE_GLASS, MEMORY:GLASS_ON_SINK,  SOUND:GLASS
$ -> CREATE_GLASS = CREATE_DECORATION -> 17-8-BACK:WORLD,1,1,GLASS_01


//// WASH HAND ////

! -> PLAYER_REACHED_SINK = GOTO -> SOUND:WATER_SINK, WAITING_BEFORE_CLEANED
$ -> WAITING_BEFORE_CLEANED = WAITFOR -> TIMER:2 ? PLAYER_TAKE_GLASS, AFFECTING:PLAYER*DISPLAY_PLAYER_NORMAL, FACING_PLAYER:DOWN, CUTSCENE:STOP


//// TAKE GLASS ////

$ -> PLAYER_TAKE_GLASS = MEMORY -> GLASS_ON_SINK ? DELETE_GLASS_HANDLER / NULL
$ -> DELETE_GLASS_HANDLER = GOTO -> DELETE_GLASS, SOUND:GLASS, CONDITION_PLAYER:GLASS
$ -> DELETE_GLASS = DELETE -> 17-8:WORLD,1


//// SEARCHING KEY ////

! -> SEARCHING_KEY = ACTION -> 3,SEARCH_KEY*KEY_SEARCH
$ -> KEY_SEARCH = TALK -> KEY_SEARCH_TOILET
! -> KNOWING_KEY_POS = ACTION -> 3,NULL