TIME -> 0 = GOTO -> NAME:REBECCA


//// STATE ////

! -> NAME_PLAYER_REBECCA = NAME -> REBECCA
! -> NAME_PLAYER_REBECCA_TOWEL = NAME -> REBECCA_TOWEL
! -> EXPRESSION_PLAYER_SUSPENSION = EXPRESSION -> SUSPENSION
! -> PLAYER_TOWEL_ANALYZER = NAME -> REBECCA_TOWEL ? MEMORY:PLAYER_IN_TOWEL_WITH_SARAH / NULL


//// SNORE ////

! -> SNORE_PLAYER = MEMORY -> AWAKE ? NULL / SNORE_AND_REPEAT
$ -> SNORE_AND_REPEAT = GOTO -> SOUND:SNORE, TEXT_ZZZ_CONDITIONAL, WAITING_BEFORE_SNORE
$ -> TEXT_ZZZ_CONDITIONAL = MENU -> TRUE ? NULL / TEXT_ZZZ
$ -> TEXT_ZZZ = CREATE_BONUSTEXT -> ONTHESPOT,NORMAL,ZZZ
$ -> WAITING_BEFORE_SNORE = WAITFOR -> TIMER:2 ? AFFECTING:PLAYER*SNORE_PLAYER


//// MOVE ////

! -> TP_PLAYER_TO_ENTRANCE = TP -> 6-2
! -> TP_PLAYER_TO_COUCH_LEFT_PART = TP -> 14-5
! -> HIDE_PLAYER = TP -> 0-17
! -> UNHIDE_PLAYER = MEMORY -> SARAH_REFUSED_HUG ? TP:6-4 / TP:6-3

! -> STOP_PLAYER = MOVE -> STOP
! -> MOVE_PLAYER_TO_MACHINE = WAITFOR -> MOVE:1-8 ? FACING:UP, AFFECTING:PLAYER_REACHED_MACHINE
! -> MOVE_PLAYER_TO_DRESSER = WAITFOR -> MOVE:6-9 ? FACING:LEFT, AFFECTING:PLAYER_REACHED_DRESSER
! -> MOVE_PLAYER_TO_BASKET = WAITFOR -> MOVE:2-10 ? FACING:RIGHT, AFFECTING:OBJ-11*PLAYER_REACHED_BASKET
! -> MOVE_PLAYER_TO_SINK = WAITFOR -> MOVE:17-9 ? FACING:UP, DISPLAY_SINK, AFFECTING:OBJ-12*PLAYER_REACHED_SINK
! -> MOVE_PLAYER_TO_FRIDGE = WAITFOR -> MOVE:2-5 ? FACING:LEFT, AFFECTING:PLAYER_REACHED_FRIDGE
! -> MOVE_PLAYER_TO_HOTPLATES = WAITFOR -> MOVE:2-3 ? FACING:UP, AFFECTING:PLAYER_REACHED_HOTPLATES
! -> MOVE_PLAYER_TO_TABLE = MOVE -> 7-4
GOAL -> 7-4 = MEMORY -> POST_ARRIVAL_PANCAKES ? AFFECTING:SARAH*PLAYER_REACHED_PANCAKES_TABLE / AFFECTING:PLAYER_REACHED_TABLE
! -> MOVE_PLAYER_TO_SIDE_STEP_ENTRANCE = FACING -> DOWN ? MOVE:5-2 / MOVE:6-3
GOAL -> 5-2 = GOTO -> FACING:RIGHT, AFFECTING:PLAYER_REACHED_SIDE_STEP_ENTRANCE
GOAL -> 6-3 = GOTO -> FACING:UP, AFFECTING:PLAYER_REACHED_SIDE_STEP_ENTRANCE
! -> MOVE_PLAYER_TO_ENTRANCE = MOVE -> 6-2
! -> MOVE_PLAYER_TO_ENTRANCE_WITH_DELAY = WAITFOR -> TIMER:1 ? MOVE:6-2
! -> MOVE_PLAYER_TO_BUFFET = WAITFOR -> MOVE:3-4 ? FACING:DOWN, AFFECTING:SARAH*PLAYER_REACHED_BUFFET
! -> MOVE_PLAYER_TO_PANCAKES_TABLE = WAITFOR -> MOVE:8-2 ? FACING:DOWN, PARSE_DUMP_PANCAKES 
$ -> PARSE_DUMP_PANCAKES = MEMORY -> DUMP_PANCAKES ? AFFECTING:PLAYER_REACHED_PANCAKES_TABLE_DUMPING / AFFECTING:SARAH*PLAYER_REACHED_PANCAKES_TABLE
! -> MOVE_PLAYER_TO_DISPUTE = WAITFOR -> MOVE:16-6 ? FACING:RIGHT
! -> MOVE_PLAYER_TO_MIDDLE = SLOW -> 11-5
GOAL -> 11-5 = MEMORY -> LEAVING_WITH_SARAH ? MOVE:10-5 / MOVE:7-4
! -> MOVE_PLAYER_TO_COUCH = MOVE -> 17-3
! -> MOVE_PLAYER_TO_TRASH = WAITFOR -> MOVE:5-5 ? FACING:LEFT, AFFECTING:PLAYER_REACHED_TRASH

! -> MOVE_PLAYER_TO_EXIT = SLOW -> 6-0
! -> MOVE_PLAYER_TO_EXIT_AFTER_DELAY = WAITFOR -> TIMER:1 ? SLOW:6-0
GOAL -> 6-0 = AFFECTING -> SET-UP*PLAYER_REACHED_EXIT

$ -> DISPLAY_SINK = DISPLAY -> 0, -14
! -> DISPLAY_PLAYER_NORMAL = DISPLAY -> 0, 0
! -> PUSH_PLAYER_UP = PUSH -> UP
! -> PUSH_PLAYER_LEFT = PUSH -> LEFT


//// DISPUTE SARAH ////

! -> DISPUTE_PLAYER_SAID_NOTHING = GOTO -> EXPRESSION:SUSPENSION, WAITING_BEFORE_STEP_AWAY
$ -> WAITING_BEFORE_STEP_AWAY = WAITFOR -> TIMER:2 ? MOVE:14-5
GOAL -> 14-5 = MEMORY -> STEAL_PHONE ? MOVE:18-9 / FACING:DOWN, AFFECTING:SARAH*SARAH_ANGRY_GOODBYE


//// COUCH ////

TALKED -> KEY_SEARCH*COUCH = MEMORY -> HORIZONTAL_COUCH_SEARCH ? MOVE:16-4 / MOVE:17-3
GOAL -> 16-4 = MEMORY -> BOTH_COUH ? NULL / FACING:DOWN, WAITING_BEFORE_SEARCHING_COUCH
GOAL -> 17-3 = GOTO -> FACING:RIGHT, PARSE_STEAL_PHONE_COUCH
$ -> PARSE_STEAL_PHONE_COUCH = MEMORY -> STEAL_PHONE ? FACING:RIGHT, STEAL_SARAH_ACTION / PARSE_BAD_JOKE
$ -> PARSE_BAD_JOKE = MEMORY -> BAD_JOKE ? FACING:RIGHT, AFFECTING:SARAH*REACHED_BAD_JOKE, MUSIC:NULL / PARSE_BOTH_COUCH
$ -> PARSE_BOTH_COUCH =  MEMORY -> BOTH_COUH ? NULL / WAITING_BEFORE_SEARCHING_COUCH
$ -> WAITING_BEFORE_SEARCHING_COUCH = WAITFOR -> TIMER:1 ? SOUND:CLOTHES, PARSE_SECOND_COUCH
$ -> PARSE_SECOND_COUCH = MEMORY -> SECOND_COUCH ? WAITING_BEFORE_TALKING_COUCH_KEY / MEMORY:SECOND_COUCH, WAITING_BEFORE_SEARCH_SECOND_COUCH
$ -> WAITING_BEFORE_SEARCH_SECOND_COUCH = WAITFOR -> TIMER:1 ? SEARCH_SECOND_COUCH
$ -> SEARCH_SECOND_COUCH = MEMORY -> HORIZONTAL_COUCH_SEARCH ? MOVE:17-3 / MOVE:16-4
$ -> WAITING_BEFORE_TALKING_COUCH_KEY = WAITFOR -> TIMER:1 ? MEMORY:BOTH_COUH, TALK_KEY_SEARCH_CONDITIONNAL
$ -> TALK_KEY_SEARCH_CONDITIONNAL = MEMORY -> KEY_SECOND_ATTEMPT ? TALK:KEY_FOUND*COUCH / FIRST_ATTEMPT_CONDITIONNAL, TALK:KEY_FAIL*COUCH
$ -> FIRST_ATTEMPT_CONDITIONNAL = MEMORY -> KEY_FIRST_ATTEMPT ? MEMORY:KEY_SECOND_ATTEMPT / MEMORY:KEY_FIRST_ATTEMPT
TALKED -> KEY_FAIL*COUCH = CUTSCENE -> STOP


//// LEAVING SARAH ////

! -> MOVE_PLAYER_TO_LEAVING_WITH_SARAH = WAITFOR -> TIMER:1 ? MOVE:11-5
GOAL -> 10-5 = MOVE -> 6-4
GOAL -> 6-4 = MEMORY -> FAST_CURVED_EXIT ? AFFECTING:PLAYER*MOVE_PLAYER_TO_ENTRANCE_WITH_DELAY / FACING:UP
! -> MOVE_PLAYER_TO_FAST_LEAVING_WITH_SARAH = MEMORY -> FAST_TRAJECTORY_CANCELED ? MEMORY:FAST_CURVED_EXIT, MOVE:6-4 / AFFECTING:PLAYER*MOVE_PLAYER_TO_ENTRANCE_WITH_DELAY
GOAL -> 3-0 = AFFECTING -> SET-UP*PLAYER_REACHED_EXIT_WITH_SARAH


//// SEARCHING KEY ////

TALKED -> KEY_FOUND*BED = GOTO -> SPAWN_KEY
TALKED -> KEY_FOUND*DRESSER = GOTO -> SPAWN_KEY
TALKED -> KEY_FOUND*PLANT = GOTO -> SPAWN_KEY
TALKED -> KEY_FOUND*CLOTHES_BASKET = GOTO -> SPAWN_KEY
TALKED -> KEY_FOUND*WASHING_MACHINE = GOTO -> SPAWN_KEY
TALKED -> KEY_FOUND*FURNITURE = GOTO -> SPAWN_KEY
TALKED -> KEY_FOUND*TOILET = GOTO -> SPAWN_KEY
TALKED -> KEY_FOUND*DESK = GOTO -> SPAWN_KEY
TALKED -> KEY_FOUND*COUCH = GOTO -> SPAWN_KEY, CUTSCENE:STOP
TALKED -> KEY_FOUND*BOOKSHELF = GOTO -> SPAWN_KEY
TALKED -> KEY_FOUND*FRIDGE = GOTO -> SPAWN_KEY
$ -> SPAWN_KEY = GOTO -> MEMORY:KNOWING_KEY_POS, AFFECTING:KNOWING_KEY_POS, CREATE_KEY, SOUND:LOOT_SPAWN
$ -> CREATE_KEY = CREATE -> ONTHESPOT-BACK:1-1-255


//// OTHER ////

! -> WAITING_BEFORE_BOOK_LIFE_DISCUSSION = WAITFOR -> TIMER:1 ? TALK:BOOK_SARAH*LIFE
$ -> STEAL_SARAH_ACTION = WAITFOR -> TIMER:1 ? SOUND:CLOTHES, WAITING_BEFORE_STEAL_KEYS
$ -> WAITING_BEFORE_STEAL_KEYS = WAITFOR -> TIMER:1 ? SOUND:KEYS, WAITING_BEFORE_SOAK_PHONE
$ -> WAITING_BEFORE_SOAK_PHONE = WAITFOR -> TIMER:1 ? MOVE:14-5
GOAL -> 18-9 = WAITFOR -> TIMER:1 ? SOUND:WATER_PLANT, SOUND:JUMP, WAITING_BEFORE_FLUSH_PHONE
$ -> WAITING_BEFORE_FLUSH_PHONE = WAITFOR -> TIMER:1 ? SOUND:TOILET_FLUSH, WAITING_BEFORE_FLUSH_PHONE_REACTION
$ -> WAITING_BEFORE_FLUSH_PHONE_REACTION = WAITFOR -> TIMER:2 ? TALK:LEAVE_WITHOUT_SARAH*STEAL_PHONE
TALKED -> LEAVE_WITHOUT_SARAH*STEAL_PHONE = MOVE -> 6-2
GOAL -> 6-2 = MEMORY -> LEAVING_WITH_SARAH ? FACING:UP, MOVE:3-0 / PARSE_STEAL_PHONE
$ -> PARSE_STEAL_PHONE = MEMORY -> STEAL_PHONE ? TALK:LEAVE_WITHOUT_SARAH*STEAL_KEY / NULL
TALKED -> LEAVE_WITHOUT_SARAH*STEAL_KEY = WAITFOR -> MOVE:7-0 ? AFFECTING:SET-UP*PLAYER_REACHED_EXIT_WITHOUT_SARAH